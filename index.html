<!DOCTYPE html>
<html lang="th">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>IT Asset Inventory</title>
    <!-- ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Browser -->
    <link rel="icon" type="image/png" sizes="32x32" href="asset1.png" />
    <!-- ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö iPhone/iPad -->
    <link rel="apple-touch-icon" sizes="180x180" href="asset2.png" />
    <!-- Manifest ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Android / PWA -->
    <link rel="manifest" href="manifest.json" />
    <!-- ‡∏™‡∏µ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ñ‡∏ö‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ -->
    <meta name="theme-color" content="#0ea5e9" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Prompt", sans-serif;
      }
      .fade-in {
        animation: fadeIn 0.3s ease-in;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .card-hover {
        transition: all 0.3s ease;
      }
      .card-hover:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      }
      .loading {
        animation: spin 1s linear infinite;
      }
      @keyframes spin {
        from {
          transform: rotate(0deg);
        }
        to {
          transform: rotate(360deg);
        }
      }

      /* Glow Effects */
      .glow-card {
        position: relative;
        transition: all 0.5s ease;
      }
      .glow-card:hover {
        box-shadow: 0 0 30px rgba(59, 130, 246, 0.3),
          0 0 60px rgba(59, 130, 246, 0.1);
      }
      .glow-border {
        position: relative;
        transition: all 0.3s ease;
      }
      .glow-border:hover {
        box-shadow: 0 0 20px rgba(6, 182, 212, 0.4);
      }
      .glow-border-red {
        transition: all 0.3s ease;
      }
      .glow-border-red:hover {
        box-shadow: 0 0 20px rgba(239, 68, 68, 0.4);
      }
      .glow-border-yellow {
        transition: all 0.3s ease;
      }
      .glow-border-yellow:hover {
        box-shadow: 0 0 20px rgba(245, 158, 11, 0.4);
      }
      .glow-border-green {
        transition: all 0.3s ease;
      }
      .glow-border-green:hover {
        box-shadow: 0 0 20px rgba(34, 197, 94, 0.4);
      }

      /* Animated Background Orbs */
      @keyframes float {
        0%,
        100% {
          transform: translateY(0px) rotate(0deg);
        }
        33% {
          transform: translateY(-20px) rotate(120deg);
        }
        66% {
          transform: translateY(10px) rotate(240deg);
        }
      }

      /* Tech Grid Animation */
      @keyframes gridPulse {
        0%,
        100% {
          opacity: 0.1;
        }
        50% {
          opacity: 0.3;
        }
      }
    </style>
  </head>
  <body class="bg-gray-50">
    <!-- Login Screen -->
    <div
      id="loginScreen"
      class="min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center relative overflow-hidden"
    >
      <!-- Animated Background Effects -->
      <div class="absolute inset-0 overflow-hidden">
        <div
          class="absolute top-20 left-20 w-96 h-96 bg-cyan-500/20 rounded-full blur-3xl animate-pulse"
        ></div>
        <div
          class="absolute bottom-20 right-20 w-80 h-80 bg-blue-500/20 rounded-full blur-3xl animate-pulse"
          style="animation-delay: 2s"
        ></div>
        <div
          class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-purple-500/20 rounded-full blur-3xl animate-pulse"
          style="animation-delay: 4s"
        ></div>
      </div>

      <!-- Grid Pattern Overlay -->
      <div
        class="absolute inset-0 opacity-10"
        style="
          background-image: radial-gradient(
            circle at 1px 1px,
            rgba(255, 255, 255, 0.3) 1px,
            transparent 0
          );
          background-size: 20px 20px;
        "
      ></div>

      <!-- Connection Status -->
      <div
        id="connectionStatus"
        class="fixed top-0 left-0 right-0 z-50 bg-blue-600 text-white text-center py-2 text-sm"
      >
        <span id="statusText">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏ö...</span>
      </div>

      <!-- Login Card -->
      <div class="relative z-10 w-full max-w-md mx-4">
        <div
          class="bg-white/10 backdrop-blur-md rounded-2xl shadow-2xl border border-white/20 p-8 glow-card"
        >
          <!-- Header -->
          <div class="text-center mb-8">
            <div class="relative mx-auto w-20 h-20 mb-6">
              <div
                class="bg-gradient-to-r from-cyan-500 to-blue-600 w-20 h-20 rounded-2xl flex items-center justify-center shadow-2xl shadow-cyan-500/30 glow-border"
              >
                <span class="text-3xl">üè¢</span>
              </div>
              <div
                class="absolute inset-0 bg-gradient-to-r from-cyan-500 to-blue-600 rounded-2xl blur-lg opacity-30 animate-pulse"
              ></div>
            </div>
            <h1
              class="text-3xl font-bold bg-gradient-to-r from-cyan-400 via-blue-400 to-purple-400 bg-clip-text text-transparent drop-shadow-lg mb-2"
            >
              IT Asset Inventory
            </h1>

            <div class="space-y-2">
              <div
                class="inline-flex items-center space-x-2 px-3 py-1.5 bg-white/10 rounded-full border border-white/20"
              >
                <div
                  class="w-1.5 h-1.5 bg-green-400 rounded-full animate-pulse"
                ></div>
                <p class="text-gray-300 text-xs sm:text-sm font-medium">
                  ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏®
                </p>
              </div>

              <div
                class="flex items-center justify-center space-x-2 text-gray-400 text-xs"
              >
                <!--<svg class="w-3 h-3" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
                            </svg>-->
                <span>‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏ó‡πà‡∏≤‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô</span>
              </div>
            </div>
            <p id="dbStatus" class="mt-2 text-xs text-yellow-600 text-center">
              ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠...
            </p>
          </div>

          <!-- Login Form -->
          <form id="loginForm" class="space-y-6">
            <div
              id="loginError"
              class="hidden bg-red-500/20 backdrop-blur-sm border border-red-500/30 rounded-xl p-4 text-red-300 text-sm text-center"
            >
              ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
            </div>

            <div class="space-y-4">
              <div>
                <label
                  class="block text-sm font-medium text-slate-300 mb-3 flex items-center"
                >
                  <svg
                    class="w-4 h-4 mr-2 text-cyan-400"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
                    ></path>
                  </svg>
                  ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
                </label>
                <div class="relative">
                  <input
                    type="text"
                    id="username"
                    class="w-full pl-12 pr-4 py-4 bg-white/10 backdrop-blur-sm border border-white/20 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 text-white placeholder-slate-400 transition-all duration-300"
                    placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ"
                    required
                    style="box-shadow: 0 0 20px rgba(6, 182, 212, 0.1)"
                  />
                  <svg
                    class="absolute left-4 top-4 w-5 h-5 text-slate-400"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
                    ></path>
                  </svg>
                </div>
              </div>

              <div>
                <label
                  class="block text-sm font-medium text-slate-300 mb-3 flex items-center"
                >
                  <svg
                    class="w-4 h-4 mr-2 text-cyan-400"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"
                    ></path>
                  </svg>
                  ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô
                </label>
                <div class="relative">
                  <input
                    type="password"
                    id="password"
                    class="w-full pl-12 pr-12 py-4 bg-white/10 backdrop-blur-sm border border-white/20 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 text-white placeholder-slate-400 transition-all duration-300"
                    placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô"
                    required
                    style="box-shadow: 0 0 20px rgba(6, 182, 212, 0.1)"
                  />
                  <svg
                    class="absolute left-4 top-4 w-5 h-5 text-slate-400"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"
                    ></path>
                  </svg>
                  <button
                    type="button"
                    id="togglePassword"
                    class="absolute right-4 top-4 text-slate-400 hover:text-slate-300 transition-colors duration-200"
                  >
                    <svg
                      class="w-5 h-5"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"
                      ></path>
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"
                      ></path>
                    </svg>
                  </button>
                </div>
              </div>
            </div>

            <button
              type="submit"
              id="loginBtn"
              class="w-full bg-gradient-to-r from-cyan-500 to-blue-600 text-white py-4 rounded-xl hover:from-cyan-600 hover:to-blue-700 transition-all duration-300 hover:scale-105 shadow-2xl shadow-cyan-500/30 hover:shadow-cyan-500/50 relative overflow-hidden font-semibold"
            >
              <div
                class="absolute inset-0 bg-gradient-to-r from-white/20 to-transparent opacity-0 hover:opacity-100 transition-opacity duration-300"
              ></div>
              <div
                class="relative z-10 flex items-center justify-center space-x-2"
              >
                <svg
                  class="w-5 h-5"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"
                  ></path>
                </svg>
                <span>‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</span>
              </div>
            </button>
          </form>

          <!-- Security Notice -->
          <div
            class="mt-6 p-4 bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl"
          >
            <div class="flex items-center text-sm text-slate-300">
              <svg
                class="w-4 h-4 mr-2 text-green-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"
                ></path>
              </svg>
              <span>‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô</span>
            </div>
          </div>
          <!-- Version Info -->
          <div class="mt-3 text-xs text-gray-500">
            <div class="flex items-center justify-center space-x-2">
              <!--<span>Version 1.0</span>
                            <div class="w-0.5 h-0.5 bg-gray-500 rounded-full"></div>-->
              <span>‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Main Application -->
    <div id="mainApp" class="hidden">
      <!-- Top Navigation -->
      <nav
        class="bg-gradient-to-r from-slate-900 via-slate-800 to-slate-900 shadow-2xl border-b border-cyan-500/20 fixed top-0 left-0 right-0 z-40 backdrop-blur-xl"
      >
        <!-- Animated Background Effects -->
        <div class="absolute inset-0 overflow-hidden">
          <div
            class="absolute top-2 left-10 w-16 h-16 bg-cyan-500/10 rounded-full blur-xl animate-pulse"
          ></div>
          <div
            class="absolute top-2 right-20 w-12 h-12 bg-blue-500/10 rounded-full blur-xl animate-pulse"
            style="animation-delay: 2s"
          ></div>
        </div>

        <!-- Grid Pattern Overlay -->
        <div
          class="absolute inset-0 opacity-5"
          style="
            background-image: radial-gradient(
              circle at 1px 1px,
              rgba(255, 255, 255, 0.3) 1px,
              transparent 0
            );
            background-size: 20px 20px;
          "
        ></div>

        <div class="px-4 lg:px-6 relative z-10">
          <div class="flex justify-between items-center py-4">
            <div class="flex items-center space-x-4">
              <!-- Mobile Menu Button -->
              <button
                id="mobileMenuBtn"
                class="lg:hidden p-2 rounded-lg text-slate-300 hover:bg-white/10 hover:text-white transition-all duration-200 backdrop-blur-sm border border-white/10"
              >
                <svg
                  class="w-6 h-6"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M4 6h16M4 12h16M4 18h16"
                  ></path>
                </svg>
              </button>

              <!-- System Status -->
              <div
                class="hidden md:flex items-center space-x-2 bg-white/10 backdrop-blur-md px-4 py-2 rounded-xl border border-green-500/30 shadow-lg shadow-green-500/20 glow-border-green"
              >
                <div
                  class="w-2 h-2 bg-green-400 rounded-full animate-pulse shadow-lg shadow-green-400/50"
                ></div>
                <span
                  class="text-sm text-green-300 font-medium"
                  id="systemStatus"
                  >‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</span
                >
              </div>

              <!-- Sync Status -->
              <div
                id="syncStatus"
                class="hidden md:flex items-center space-x-2 bg-white/10 backdrop-blur-md px-4 py-2 rounded-xl border border-cyan-500/30 shadow-lg shadow-cyan-500/20 glow-border"
              >
                <div
                  class="w-2 h-2 bg-cyan-400 rounded-full animate-pulse shadow-lg shadow-cyan-400/50"
                ></div>
                <span
                  class="text-sm text-cyan-300 font-medium"
                  id="syncStatusText"
                  >‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠...</span
                >
              </div>
            </div>

            <div class="flex items-center space-x-4">
              <!-- User Info -->
              <div class="flex items-center space-x-3">
                <div class="hidden md:block text-right">
                  <p
                    class="text-sm font-semibold text-white drop-shadow-lg"
                    id="currentUserName"
                  >
                    Admin
                  </p>
                  <p class="text-xs text-slate-300" id="currentUserRole">
                    ‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö
                  </p>
                </div>
                <div class="relative">
                  <button
                    id="userMenuBtn"
                    class="flex items-center space-x-2 bg-gradient-to-r from-cyan-500 to-blue-600 text-white px-4 py-2 rounded-xl hover:from-cyan-600 hover:to-blue-700 transition-all duration-300 hover:scale-105 shadow-2xl shadow-cyan-500/30 hover:shadow-cyan-500/50 relative overflow-hidden"
                  >
                    <div
                      class="absolute inset-0 bg-gradient-to-r from-white/20 to-transparent opacity-0 hover:opacity-100 transition-opacity duration-300"
                    ></div>
                    <div
                      class="relative z-10 w-8 h-8 bg-white/20 backdrop-blur-sm rounded-lg flex items-center justify-center"
                    >
                      <svg
                        class="w-4 h-4"
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                      >
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="2"
                          d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
                        ></path>
                      </svg>
                    </div>
                    <span
                      class="hidden md:block text-sm font-medium relative z-10"
                      id="headerUsername"
                      >admin</span
                    >
                    <svg
                      class="w-4 h-4 relative z-10"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M19 9l-7 7-7-7"
                      ></path>
                    </svg>
                  </button>

                  <!-- User Dropdown Menu -->
                  <div
                    id="userDropdown"
                    class="hidden absolute right-0 mt-2 w-48 bg-slate-800/95 backdrop-blur-md rounded-xl shadow-2xl border border-white/20 py-2 z-50"
                  >
                    <div class="px-4 py-3 border-b border-white/20">
                      <p
                        class="text-sm font-semibold text-white"
                        id="dropdownUserName"
                      >
                        Admin
                      </p>
                      <p class="text-xs text-slate-300" id="dropdownUserRole">
                        ‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö
                      </p>
                    </div>
                    <button
                      onclick="logout()"
                      class="w-full text-left px-4 py-3 text-sm text-red-300 hover:bg-red-500/20 hover:text-red-200 transition-colors duration-200 flex items-center space-x-2"
                    >
                      <svg
                        class="w-4 h-4"
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                      >
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="2"
                          d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"
                        ></path>
                      </svg>
                      <span>‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</span>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </nav>

      <!-- Tech Sidebar -->
      <div
        id="sidebar"
        class="fixed left-0 top-16 h-full w-72 bg-gradient-to-b from-slate-900 via-slate-800 to-slate-900 shadow-2xl border-r border-cyan-500/20 z-30 flex flex-col backdrop-blur-xl transform -translate-x-full lg:translate-x-0 transition-transform duration-300 ease-in-out"
      >
        <!-- Animated Background Effects -->
        <div class="absolute inset-0 overflow-hidden">
          <div
            class="absolute top-10 left-10 w-32 h-32 bg-cyan-500/10 rounded-full blur-2xl animate-pulse"
          ></div>
          <div
            class="absolute bottom-20 right-10 w-24 h-24 bg-blue-500/10 rounded-full blur-2xl animate-pulse"
            style="animation-delay: 2s"
          ></div>
          <div
            class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-20 h-20 bg-purple-500/10 rounded-full blur-2xl animate-pulse"
            style="animation-delay: 4s"
          ></div>
        </div>

        <!-- Grid Pattern Overlay -->
        <div
          class="absolute inset-0 opacity-5"
          style="
            background-image: radial-gradient(
              circle at 1px 1px,
              rgba(255, 255, 255, 0.3) 1px,
              transparent 0
            );
            background-size: 20px 20px;
          "
        ></div>

        <!-- Header Section -->
        <div class="relative z-10 p-6 border-b border-cyan-500/20">
          <div class="flex items-center space-x-4 mb-6">
            <div class="relative">
              <div
                class="bg-gradient-to-r from-cyan-500 to-blue-600 w-12 h-12 rounded-xl flex items-center justify-center shadow-2xl shadow-cyan-500/30 glow-border"
              >
                <span class="text-2xl">üè¢</span>
              </div>
              <div
                class="absolute inset-0 bg-gradient-to-r from-cyan-500 to-blue-600 rounded-xl blur-lg opacity-30 animate-pulse"
              ></div>
            </div>
            <div>
              <h1
                class="text-xl font-bold bg-gradient-to-r from-cyan-400 via-blue-400 to-purple-400 bg-clip-text text-transparent drop-shadow-lg"
              >
                IT Asset Inventory
              </h1>
              <p class="text-xs text-slate-400 mt-1">
                ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏®
              </p>
            </div>
          </div>

          <!-- Status Indicator -->
          <div
            class="bg-white/5 backdrop-blur-sm border border-green-500/30 rounded-xl p-3 shadow-lg shadow-green-500/10 glow-border-green"
          >
            <div class="flex items-center justify-between">
              <div class="flex items-center space-x-2">
                <div
                  class="w-2 h-2 bg-green-400 rounded-full animate-pulse shadow-lg shadow-green-400/50"
                ></div>
                <span class="text-xs text-green-300 font-medium"
                  >System Online</span
                >
              </div>
              <div class="text-xs text-slate-400" id="systemTime">--:--</div>
            </div>
          </div>
        </div>

        <!-- Navigation Menu -->
        <div class="relative z-10 p-6 flex-1">
          <nav class="space-y-3">
            <!-- Dashboard -->
            <button
              class="tech-nav-btn active w-full text-left group"
              data-section="dashboard"
              id="menuDashboard"
            >
              <div class="flex items-center space-x-4">
                <div class="relative">
                  <div
                    class="bg-gradient-to-r from-cyan-500 to-blue-600 w-10 h-10 rounded-lg flex items-center justify-center shadow-lg shadow-cyan-500/30 group-hover:shadow-cyan-500/50 transition-all duration-300"
                  >
                    <svg
                      class="w-5 h-5 text-white"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"
                      ></path>
                    </svg>
                  </div>
                  <div
                    class="absolute inset-0 bg-gradient-to-r from-cyan-500 to-blue-600 rounded-lg blur-md opacity-0 group-hover:opacity-40 transition-opacity duration-300"
                  ></div>
                </div>
                <div class="flex-1">
                  <span
                    class="text-white font-medium group-hover:text-cyan-300 transition-colors duration-200"
                    >Dashboard</span
                  >
                  <p
                    class="text-xs text-slate-400 group-hover:text-slate-300 transition-colors duration-200"
                  >
                    ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏£‡∏∞‡∏ö‡∏ö
                  </p>
                </div>
                <div
                  class="w-2 h-2 bg-cyan-400 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-200 shadow-lg shadow-cyan-400/50"
                ></div>
              </div>
            </button>

            <!-- Assets Management -->
            <button
              class="tech-nav-btn w-full text-left group"
              data-section="assets"
              id="menuAssets"
            >
              <div class="flex items-center space-x-4">
                <div class="relative">
                  <div
                    class="bg-gradient-to-r from-emerald-500 to-green-600 w-10 h-10 rounded-lg flex items-center justify-center shadow-lg shadow-emerald-500/30 group-hover:shadow-emerald-500/50 transition-all duration-300"
                  >
                    <svg
                      class="w-5 h-5 text-white"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"
                      ></path>
                    </svg>
                  </div>
                  <div
                    class="absolute inset-0 bg-gradient-to-r from-emerald-500 to-green-600 rounded-lg blur-md opacity-0 group-hover:opacity-40 transition-opacity duration-300"
                  ></div>
                </div>
                <div class="flex-1">
                  <span
                    class="text-white font-medium group-hover:text-emerald-300 transition-colors duration-200"
                    >‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</span
                  >
                  <p
                    class="text-xs text-slate-400 group-hover:text-slate-300 transition-colors duration-200"
                  >
                    ‡πÄ‡∏û‡∏¥‡πà‡∏° ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
                  </p>
                </div>
                <div
                  class="w-2 h-2 bg-emerald-400 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-200 shadow-lg shadow-emerald-400/50"
                ></div>
              </div>
            </button>

            <!-- Reports -->
            <button
              class="tech-nav-btn w-full text-left group"
              data-section="reports"
              id="menuReports"
            >
              <div class="flex items-center space-x-4">
                <div class="relative">
                  <div
                    class="bg-gradient-to-r from-purple-500 to-violet-600 w-10 h-10 rounded-lg flex items-center justify-center shadow-lg shadow-purple-500/30 group-hover:shadow-purple-500/50 transition-all duration-300"
                  >
                    <svg
                      class="w-5 h-5 text-white"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
                      ></path>
                    </svg>
                  </div>
                  <div
                    class="absolute inset-0 bg-gradient-to-r from-purple-500 to-violet-600 rounded-lg blur-md opacity-0 group-hover:opacity-40 transition-opacity duration-300"
                  ></div>
                </div>
                <div class="flex-1">
                  <span
                    class="text-white font-medium group-hover:text-purple-300 transition-colors duration-200"
                    >‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</span
                  >
                  <p
                    class="text-xs text-slate-400 group-hover:text-slate-300 transition-colors duration-200"
                  >
                    ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                  </p>
                </div>
                <div
                  class="w-2 h-2 bg-purple-400 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-200 shadow-lg shadow-purple-400/50"
                ></div>
              </div>
            </button>
          </nav>

          <!-- Quick Stats Panel -->
          <div
            class="mt-8 bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl p-4 shadow-lg glow-card"
          >
            <h3 class="text-sm font-semibold text-white mb-3 flex items-center">
              <svg
                class="w-4 h-4 mr-2 text-cyan-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M13 10V3L4 14h7v7l9-11h-7z"
                ></path>
              </svg>
              ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏î‡πà‡∏ß‡∏ô
            </h3>
            <div class="space-y-2">
              <div class="flex items-center justify-between text-xs">
                <span class="text-slate-300">‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span>
                <span class="text-cyan-400 font-bold" id="sidebarTotalAssets"
                  >0</span
                >
              </div>
              <div class="flex items-center justify-between text-xs">
                <span class="text-slate-300">‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏á</span>
                <span class="text-red-400 font-bold" id="sidebarHighRisk"
                  >0</span
                >
              </div>
              <div class="flex items-center justify-between text-xs">
                <span class="text-slate-300">‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥</span>
                <span class="text-green-400 font-bold" id="sidebarActive"
                  >0</span
                >
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Dashboard Section -->
      <div
        id="dashboard"
        class="section active ml-0 lg:ml-72 pt-20 px-4 md:px-6 lg:px-8 py-8 bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 min-h-screen relative overflow-hidden"
        style="display: block"
      >
        <!-- Tech Background Effects -->
        <div class="absolute inset-0 opacity-20">
          <div
            class="absolute top-20 left-20 w-96 h-96 bg-blue-500/20 rounded-full blur-3xl animate-pulse"
          ></div>
          <div
            class="absolute bottom-20 right-20 w-80 h-80 bg-purple-500/20 rounded-full blur-3xl animate-pulse"
            style="animation-delay: 2s"
          ></div>
          <div
            class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-cyan-500/20 rounded-full blur-3xl animate-pulse"
            style="animation-delay: 4s"
          ></div>
        </div>

        <!-- Grid Pattern Overlay -->
        <div
          class="absolute inset-0 opacity-10"
          style="
            background-image: radial-gradient(
              circle at 1px 1px,
              rgba(255, 255, 255, 0.3) 1px,
              transparent 0
            );
            background-size: 20px 20px;
          "
        ></div>

        <!-- Header Section -->
        <div class="mb-8 relative z-10">
          <div class="flex items-center justify-between">
            <div>
              <h2
                class="text-4xl font-bold bg-gradient-to-r from-cyan-400 via-blue-400 to-purple-400 bg-clip-text text-transparent mb-2 drop-shadow-lg"
              >
                IT Asset Dashboard
              </h2>
              <p class="text-slate-300 text-lg">
                ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏®
              </p>
            </div>
            <div class="flex items-center space-x-4">
              <!--<div class="bg-white/10 backdrop-blur-md px-4 py-2 rounded-xl border border-cyan-500/30 shadow-2xl shadow-cyan-500/20 glow-border">
                            <div class="flex items-center space-x-2">
                                <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse shadow-lg shadow-green-400/50"></div>
                                <span class="text-sm text-slate-200 font-medium">Real-time</span>
                            </div>
                        </div>-->
              <div
                class="bg-white/10 backdrop-blur-md px-4 py-2 rounded-xl border border-purple-500/30 shadow-2xl shadow-purple-500/20 glow-border"
              >
                <span class="text-sm text-slate-200 font-medium" id="lastUpdate"
                  >‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà</span
                >
              </div>
            </div>
          </div>
        </div>

        <!-- Main Stats Cards -->
        <div
          class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8 relative z-10"
        >
          <!-- Hardware Card -->
          <div
            class="group relative bg-white/10 backdrop-blur-md p-6 rounded-2xl border border-cyan-500/30 shadow-2xl shadow-cyan-500/20 hover:shadow-cyan-500/40 transition-all duration-500 hover:scale-105 overflow-hidden glow-card"
          >
            <div
              class="absolute inset-0 bg-gradient-to-br from-cyan-500/20 via-blue-500/10 to-transparent"
            ></div>
            <div
              class="absolute inset-0 bg-gradient-to-br from-transparent via-transparent to-cyan-500/5"
            ></div>
            <div class="relative z-10">
              <div class="flex items-center justify-between mb-4">
                <div
                  class="bg-cyan-500/20 backdrop-blur-sm p-3 rounded-xl border border-cyan-400/30 shadow-lg shadow-cyan-500/20"
                >
                  <svg
                    class="w-8 h-8 text-cyan-300"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"
                    ></path>
                  </svg>
                </div>
                <div class="text-right">
                  <p class="text-cyan-200 text-sm font-medium tracking-wide">
                    Hardware
                  </p>
                  <p
                    class="text-4xl font-bold text-white drop-shadow-lg"
                    id="hardwareCount"
                  >
                    0
                  </p>
                </div>
              </div>
              <div class="flex items-center text-cyan-100 text-sm">
                <svg
                  class="w-4 h-4 mr-2"
                  fill="currentColor"
                  viewBox="0 0 20 20"
                >
                  <path
                    fill-rule="evenodd"
                    d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z"
                    clip-rule="evenodd"
                  ></path>
                </svg>
                <span>‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå, ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå, ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ï‡πà‡∏≠‡∏û‡πà‡∏ß‡∏á</span>
              </div>
            </div>
            <div class="absolute -bottom-4 -right-4 opacity-10">
              <svg
                class="w-24 h-24 text-cyan-300"
                fill="currentColor"
                viewBox="0 0 20 20"
              >
                <path
                  d="M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"
                ></path>
              </svg>
            </div>
          </div>

          <!-- Software Card -->
          <div
            class="group relative bg-white/10 backdrop-blur-md p-6 rounded-2xl border border-emerald-500/30 shadow-2xl shadow-emerald-500/20 hover:shadow-emerald-500/40 transition-all duration-500 hover:scale-105 overflow-hidden glow-card"
          >
            <div
              class="absolute inset-0 bg-gradient-to-br from-emerald-500/20 via-green-500/10 to-transparent"
            ></div>
            <div
              class="absolute inset-0 bg-gradient-to-br from-transparent via-transparent to-emerald-500/5"
            ></div>
            <div class="relative z-10">
              <div class="flex items-center justify-between mb-4">
                <div
                  class="bg-emerald-500/20 backdrop-blur-sm p-3 rounded-xl border border-emerald-400/30 shadow-lg shadow-emerald-500/20"
                >
                  <svg
                    class="w-8 h-8 text-emerald-300"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"
                    ></path>
                  </svg>
                </div>
                <div class="text-right">
                  <p class="text-emerald-200 text-sm font-medium tracking-wide">
                    Software
                  </p>
                  <p
                    class="text-4xl font-bold text-white drop-shadow-lg"
                    id="softwareCount"
                  >
                    0
                  </p>
                </div>
              </div>
              <div class="flex items-center text-emerald-100 text-sm">
                <svg
                  class="w-4 h-4 mr-2"
                  fill="currentColor"
                  viewBox="0 0 20 20"
                >
                  <path
                    fill-rule="evenodd"
                    d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z"
                    clip-rule="evenodd"
                  ></path>
                </svg>
                <span>‡∏£‡∏∞‡∏ö‡∏ö, ‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô, ‡πÑ‡∏•‡πÄ‡∏ã‡∏ô‡∏™‡πå</span>
              </div>
            </div>
            <div class="absolute -bottom-4 -right-4 opacity-10">
              <svg
                class="w-24 h-24 text-emerald-300"
                fill="currentColor"
                viewBox="0 0 20 20"
              >
                <path
                  d="M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3z"
                ></path>
              </svg>
            </div>
          </div>

          <!-- Network Card -->
          <div
            class="group relative bg-white/10 backdrop-blur-md p-6 rounded-2xl border border-purple-500/30 shadow-2xl shadow-purple-500/20 hover:shadow-purple-500/40 transition-all duration-500 hover:scale-105 overflow-hidden glow-card"
          >
            <div
              class="absolute inset-0 bg-gradient-to-br from-purple-500/20 via-violet-500/10 to-transparent"
            ></div>
            <div
              class="absolute inset-0 bg-gradient-to-br from-transparent via-transparent to-purple-500/5"
            ></div>
            <div class="relative z-10">
              <div class="flex items-center justify-between mb-4">
                <div
                  class="bg-purple-500/20 backdrop-blur-sm p-3 rounded-xl border border-purple-400/30 shadow-lg shadow-purple-500/20"
                >
                  <svg
                    class="w-8 h-8 text-purple-300"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"
                    ></path>
                  </svg>
                </div>
                <div class="text-right">
                  <p class="text-purple-200 text-sm font-medium tracking-wide">
                    Network
                  </p>
                  <p
                    class="text-4xl font-bold text-white drop-shadow-lg"
                    id="networkCount"
                  >
                    0
                  </p>
                </div>
              </div>
              <div class="flex items-center text-purple-100 text-sm">
                <svg
                  class="w-4 h-4 mr-2"
                  fill="currentColor"
                  viewBox="0 0 20 20"
                >
                  <path
                    fill-rule="evenodd"
                    d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z"
                    clip-rule="evenodd"
                  ></path>
                </svg>
                <span>‡∏™‡∏ß‡∏¥‡∏ï‡∏ä‡πå, ‡πÄ‡∏£‡πâ‡∏≤‡πÄ‡∏ï‡∏≠‡∏£‡πå, ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢</span>
              </div>
            </div>
            <div class="absolute -bottom-4 -right-4 opacity-10">
              <svg
                class="w-24 h-24 text-purple-300"
                fill="currentColor"
                viewBox="0 0 20 20"
              >
                <path
                  fill-rule="evenodd"
                  d="M2 5a2 2 0 012-2h8a2 2 0 012 2v10a2 2 0 002 2H4a2 2 0 01-2-2V5zm3 1h6v4H5V6zm6 6H5v2h6v-2z"
                  clip-rule="evenodd"
                ></path>
              </svg>
            </div>
          </div>

          <!-- Data Card -->
          <div
            class="group relative bg-white/10 backdrop-blur-md p-6 rounded-2xl border border-orange-500/30 shadow-2xl shadow-orange-500/20 hover:shadow-orange-500/40 transition-all duration-500 hover:scale-105 overflow-hidden glow-card"
          >
            <div
              class="absolute inset-0 bg-gradient-to-br from-orange-500/20 via-amber-500/10 to-transparent"
            ></div>
            <div
              class="absolute inset-0 bg-gradient-to-br from-transparent via-transparent to-orange-500/5"
            ></div>
            <div class="relative z-10">
              <div class="flex items-center justify-between mb-4">
                <div
                  class="bg-orange-500/20 backdrop-blur-sm p-3 rounded-xl border border-orange-400/30 shadow-lg shadow-orange-500/20"
                >
                  <svg
                    class="w-8 h-8 text-orange-300"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
                    ></path>
                  </svg>
                </div>
                <div class="text-right">
                  <p class="text-orange-200 text-sm font-medium tracking-wide">
                    Data & Docs
                  </p>
                  <p
                    class="text-4xl font-bold text-white drop-shadow-lg"
                    id="dataCount"
                  >
                    0
                  </p>
                </div>
              </div>
              <div class="flex items-center text-orange-100 text-sm">
                <svg
                  class="w-4 h-4 mr-2"
                  fill="currentColor"
                  viewBox="0 0 20 20"
                >
                  <path
                    fill-rule="evenodd"
                    d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z"
                    clip-rule="evenodd"
                  ></path>
                </svg>
                <span>‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</span>
              </div>
            </div>
            <div class="absolute -bottom-4 -right-4 opacity-10">
              <svg
                class="w-24 h-24 text-orange-300"
                fill="currentColor"
                viewBox="0 0 20 20"
              >
                <path
                  fill-rule="evenodd"
                  d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z"
                  clip-rule="evenodd"
                ></path>
              </svg>
            </div>
          </div>
        </div>

        <!-- Risk Analysis, Repair Status & Alerts Section -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8 relative z-10">
          <!-- Risk Analysis -->
          <div
            class="bg-white/10 backdrop-blur-md p-6 rounded-2xl shadow-2xl border border-white/20 glow-card"
          >
            <div class="flex items-center justify-between mb-6">
              <h3 class="text-xl font-bold text-white flex items-center">
                <div
                  class="bg-gradient-to-r from-red-500 to-orange-500 p-2 rounded-lg mr-3 shadow-lg shadow-red-500/30"
                >
                  <svg
                    class="w-5 h-5 text-white"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"
                    ></path>
                  </svg>
                </div>
                Risk Analysis
              </h3>
              <!--<div class="text-sm text-slate-300">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå</div>-->
            </div>

            <div class="space-y-4">
              <!-- High Risk -->
              <div
                class="flex items-center justify-between p-4 bg-red-500/10 backdrop-blur-sm rounded-xl border border-red-500/30 shadow-lg shadow-red-500/20 glow-border-red"
              >
                <div class="flex items-center">
                  <div
                    class="bg-red-500/20 backdrop-blur-sm p-2 rounded-lg mr-4 border border-red-400/30 shadow-lg shadow-red-500/20"
                  >
                    <svg
                      class="w-5 h-5 text-red-300"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"
                      ></path>
                    </svg>
                  </div>
                  <div>
                    <p class="font-semibold text-red-200">‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏á</p>
                    <p class="text-sm text-red-300">‡∏Ñ‡∏ß‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏î‡∏π‡πÅ‡∏•‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©</p>
                  </div>
                </div>
                <div class="text-right">
                  <p
                    class="text-2xl font-bold text-red-300 drop-shadow-lg"
                    id="highRiskCount"
                  >
                    0
                  </p>
                  <p class="text-sm text-red-400">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</p>
                </div>
              </div>

              <!-- Medium Risk -->
              <div
                class="flex items-center justify-between p-4 bg-yellow-500/10 backdrop-blur-sm rounded-xl border border-yellow-500/30 shadow-lg shadow-yellow-500/20 glow-border-yellow"
              >
                <div class="flex items-center">
                  <div
                    class="bg-yellow-500/20 backdrop-blur-sm p-2 rounded-lg mr-4 border border-yellow-400/30 shadow-lg shadow-yellow-500/20"
                  >
                    <svg
                      class="w-5 h-5 text-yellow-300"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                      ></path>
                    </svg>
                  </div>
                  <div>
                    <p class="font-semibold text-yellow-200">
                      ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á
                    </p>
                    <p class="text-sm text-yellow-300">‡∏Ñ‡∏ß‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏Å‡∏•‡πâ‡∏ä‡∏¥‡∏î</p>
                  </div>
                </div>
                <div class="text-right">
                  <p
                    class="text-2xl font-bold text-yellow-300 drop-shadow-lg"
                    id="mediumRiskCount"
                  >
                    0
                  </p>
                  <p class="text-sm text-yellow-400">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</p>
                </div>
              </div>

              <!-- Low Risk -->
              <div
                class="flex items-center justify-between p-4 bg-green-500/10 backdrop-blur-sm rounded-xl border border-green-500/30 shadow-lg shadow-green-500/20 glow-border-green"
              >
                <div class="flex items-center">
                  <div
                    class="bg-green-500/20 backdrop-blur-sm p-2 rounded-lg mr-4 border border-green-400/30 shadow-lg shadow-green-500/20"
                  >
                    <svg
                      class="w-5 h-5 text-green-300"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"
                      ></path>
                    </svg>
                  </div>
                  <div>
                    <p class="font-semibold text-green-200">‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ï‡πà‡∏≥</p>
                    <p class="text-sm text-green-300">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏Å‡∏ï‡∏¥</p>
                  </div>
                </div>
                <div class="text-right">
                  <p
                    class="text-2xl font-bold text-green-300 drop-shadow-lg"
                    id="lowRiskCount"
                  >
                    0
                  </p>
                  <p class="text-sm text-green-400">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</p>
                </div>
              </div>
            </div>
          </div>

          <!-- Repair Status Panel -->
          <div
            class="bg-white/10 backdrop-blur-md p-6 rounded-2xl shadow-2xl border border-white/20 glow-card"
          >
            <div class="flex items-center justify-between mb-6">
              <h3 class="text-xl font-bold text-white flex items-center">
                <div
                  class="bg-gradient-to-r from-orange-500 to-red-500 p-2 rounded-lg mr-3 shadow-lg shadow-orange-500/30"
                >
                  <svg
                    class="w-5 h-5 text-white"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"
                    ></path>
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"
                    ></path>
                  </svg>
                </div>
                ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°
              </h3>
              <div
                class="bg-orange-500/20 backdrop-blur-sm text-orange-300 px-3 py-1.5 rounded-full text-xs font-medium border border-orange-400/30 shadow-lg shadow-orange-500/20"
                id="repairBadge"
              >
                0
              </div>
            </div>

            <div id="repairList" class="space-y-3 max-h-80 overflow-y-auto">
              <div class="flex items-center justify-center py-8 text-gray-400">
                <div class="text-center">
                  <svg
                    class="w-12 h-12 mx-auto mb-3 opacity-50"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"
                    ></path>
                  </svg>
                  <p class="text-sm">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°</p>
                  <p class="text-xs mt-1">‡∏ó‡∏∏‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥</p>
                </div>
              </div>
            </div>
          </div>

          <!-- Alerts Panel -->
          <div
            class="bg-white/10 backdrop-blur-md p-6 rounded-2xl shadow-2xl border border-white/20 glow-card"
          >
            <div class="flex items-center justify-between mb-6">
              <h3 class="text-xl font-bold text-white flex items-center">
                <div
                  class="bg-gradient-to-r from-amber-500 to-orange-500 p-2 rounded-lg mr-3 shadow-lg shadow-amber-500/30"
                >
                  <svg
                    class="w-5 h-5 text-white"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M15 17h5l-5 5v-5zM4.828 7l6.586 6.586a2 2 0 002.828 0l6.586-6.586A2 2 0 0019.414 5H4.586A2 2 0 003.172 7z"
                    ></path>
                  </svg>
                </div>
                ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
              </h3>
              <div
                class="bg-red-500/20 backdrop-blur-sm text-red-300 px-3 py-1.5 rounded-full text-xs font-medium border border-red-400/30 shadow-lg shadow-red-500/20"
                id="alertBadge"
              >
                0
              </div>
            </div>

            <div id="alertsList" class="space-y-3 max-h-80 overflow-y-auto">
              <div class="flex items-center justify-center py-8 text-gray-400">
                <div class="text-center">
                  <svg
                    class="w-12 h-12 mx-auto mb-3 opacity-50"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"
                    ></path>
                  </svg>
                  <p class="text-sm">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</p>
                  <p class="text-xs mt-1">‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Assets Management Section -->
      <div
        id="assets"
        class="section ml-0 lg:ml-72 pt-20 px-4 md:px-6 lg:px-8 py-8 bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 min-h-screen relative overflow-hidden"
        style="display: none"
      >
        <!-- Tech Background Effects -->
        <div class="absolute inset-0 opacity-20">
          <div
            class="absolute top-20 left-20 w-96 h-96 bg-blue-500/20 rounded-full blur-3xl animate-pulse"
          ></div>
          <div
            class="absolute bottom-20 right-20 w-80 h-80 bg-purple-500/20 rounded-full blur-3xl animate-pulse"
            style="animation-delay: 2s"
          ></div>
          <div
            class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-cyan-500/20 rounded-full blur-3xl animate-pulse"
            style="animation-delay: 4s"
          ></div>
        </div>

        <!-- Grid Pattern Overlay -->
        <div
          class="absolute inset-0 opacity-10"
          style="
            background-image: radial-gradient(
              circle at 1px 1px,
              rgba(255, 255, 255, 0.3) 1px,
              transparent 0
            );
            background-size: 20px 20px;
          "
        ></div>

        <!-- Header Section -->
        <div class="mb-8 relative z-10">
          <div class="flex items-center justify-between">
            <div>
              <h2
                class="text-4xl font-bold bg-gradient-to-r from-cyan-400 via-blue-400 to-purple-400 bg-clip-text text-transparent mb-2 drop-shadow-lg"
              >
                IT Asset Management
              </h2>
              <p class="text-slate-300 text-lg">
                ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏®
              </p>
            </div>
            <div class="flex items-center space-x-4">
              <!--<div class="bg-white/10 backdrop-blur-md px-4 py-2 rounded-xl border border-cyan-500/30 shadow-2xl shadow-cyan-500/20 glow-border">
                            <div class="flex items-center space-x-2">
                                <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse shadow-lg shadow-green-400/50"></div>
                                <span class="text-sm text-slate-200 font-medium">Live Data</span>
                            </div>
                        </div>-->
              <button
                id="addAssetBtn"
                class="group bg-gradient-to-r from-cyan-500 to-blue-600 text-white px-6 py-3 rounded-xl hover:from-cyan-600 hover:to-blue-700 transition-all duration-300 hover:scale-105 shadow-2xl shadow-cyan-500/30 hover:shadow-cyan-500/50 relative overflow-hidden"
              >
                <div
                  class="absolute inset-0 bg-gradient-to-r from-white/20 to-transparent opacity-0 hover:opacity-100 transition-opacity duration-300"
                ></div>
                <div class="relative z-10 flex items-center space-x-2">
                  <svg
                    class="w-5 h-5"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M12 6v6m0 0v6m0-6h6m-6 0H6"
                    ></path>
                  </svg>
                  <span>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå</span>
                </div>
              </button>
            </div>
          </div>
        </div>

        <!-- Quick Stats Cards -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8 relative z-10">
          <div
            class="group relative bg-white/10 backdrop-blur-md p-6 rounded-2xl border border-cyan-500/30 shadow-2xl shadow-cyan-500/20 hover:shadow-cyan-500/40 transition-all duration-500 hover:scale-105 overflow-hidden glow-card"
          >
            <div
              class="absolute inset-0 bg-gradient-to-br from-cyan-500/20 via-blue-500/10 to-transparent"
            ></div>
            <div class="relative z-10">
              <div class="flex items-center justify-between">
                <div>
                  <p class="text-cyan-200 text-sm font-medium tracking-wide">
                    ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                  </p>
                  <p
                    class="text-3xl font-bold text-white drop-shadow-lg"
                    id="totalAssetsCount"
                  >
                    0
                  </p>
                </div>
                <div
                  class="bg-cyan-500/20 backdrop-blur-sm p-3 rounded-xl border border-cyan-400/30 shadow-lg shadow-cyan-500/20"
                >
                  <svg
                    class="w-6 h-6 text-cyan-300"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"
                    ></path>
                  </svg>
                </div>
              </div>
            </div>
          </div>

          <div
            class="group relative bg-white/10 backdrop-blur-md p-6 rounded-2xl border border-emerald-500/30 shadow-2xl shadow-emerald-500/20 hover:shadow-emerald-500/40 transition-all duration-500 hover:scale-105 overflow-hidden glow-card"
          >
            <div
              class="absolute inset-0 bg-gradient-to-br from-emerald-500/20 via-green-500/10 to-transparent"
            ></div>
            <div class="relative z-10">
              <div class="flex items-center justify-between">
                <div>
                  <p class="text-emerald-200 text-sm font-medium tracking-wide">
                    ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
                  </p>
                  <p
                    class="text-3xl font-bold text-white drop-shadow-lg"
                    id="activeAssetsCount"
                  >
                    0
                  </p>
                </div>
                <div
                  class="bg-emerald-500/20 backdrop-blur-sm p-3 rounded-xl border border-emerald-400/30 shadow-lg shadow-emerald-500/20"
                >
                  <svg
                    class="w-6 h-6 text-emerald-300"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"
                    ></path>
                  </svg>
                </div>
              </div>
            </div>
          </div>

          <div
            class="group relative bg-white/10 backdrop-blur-md p-6 rounded-2xl border border-red-500/30 shadow-2xl shadow-red-500/20 hover:shadow-red-500/40 transition-all duration-500 hover:scale-105 overflow-hidden glow-card"
          >
            <div
              class="absolute inset-0 bg-gradient-to-br from-red-500/20 via-pink-500/10 to-transparent"
            ></div>
            <div class="relative z-10">
              <div class="flex items-center justify-between">
                <div>
                  <p class="text-red-200 text-sm font-medium tracking-wide">
                    ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏á
                  </p>
                  <p
                    class="text-3xl font-bold text-white drop-shadow-lg"
                    id="highRiskAssetsCount"
                  >
                    0
                  </p>
                </div>
                <div
                  class="bg-red-500/20 backdrop-blur-sm p-3 rounded-xl border border-red-400/30 shadow-lg shadow-red-500/20"
                >
                  <svg
                    class="w-6 h-6 text-red-300"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"
                    ></path>
                  </svg>
                </div>
              </div>
            </div>
          </div>

          <div
            class="group relative bg-white/10 backdrop-blur-md p-6 rounded-2xl border border-orange-500/30 shadow-2xl shadow-orange-500/20 hover:shadow-orange-500/40 transition-all duration-500 hover:scale-105 overflow-hidden glow-card"
          >
            <div
              class="absolute inset-0 bg-gradient-to-br from-orange-500/20 via-amber-500/10 to-transparent"
            ></div>
            <div class="relative z-10">
              <div class="flex items-center justify-between">
                <div>
                  <p class="text-orange-200 text-sm font-medium tracking-wide">
                    ‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°
                  </p>
                  <p
                    class="text-3xl font-bold text-white drop-shadow-lg"
                    id="repairAssetsCount"
                  >
                    0
                  </p>
                </div>
                <div
                  class="bg-orange-500/20 backdrop-blur-sm p-3 rounded-xl border border-orange-400/30 shadow-lg shadow-orange-500/20"
                >
                  <svg
                    class="w-6 h-6 text-orange-300"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"
                    ></path>
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"
                    ></path>
                  </svg>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Advanced Filters -->
        <div
          class="bg-white/10 backdrop-blur-md p-6 rounded-2xl shadow-2xl border border-white/20 mb-8 glow-card relative z-10"
        >
          <div class="flex items-center justify-between mb-6">
            <h3 class="text-xl font-bold text-white flex items-center">
              <div
                class="bg-gradient-to-r from-purple-500 to-blue-500 p-2 rounded-lg mr-3 shadow-lg shadow-purple-500/30"
              >
                <svg
                  class="w-5 h-5 text-white"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.707A1 1 0 013 7V4z"
                  ></path>
                </svg>
              </div>
              ‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            </h3>
            <button
              onclick="clearFilters()"
              class="text-sm text-slate-300 hover:text-white flex items-center bg-white/10 backdrop-blur-sm px-3 py-2 rounded-lg border border-white/20 hover:bg-white/20 transition-all duration-200"
            >
              <svg
                class="w-4 h-4 mr-1"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"
                ></path>
              </svg>
              ‡∏•‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á
            </button>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
            <div class="relative">
              <label
                class="block text-sm font-medium text-slate-300 mb-3 flex items-center"
              >
                <svg
                  class="w-4 h-4 mr-2 text-cyan-400"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                  ></path>
                </svg>
                ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
              </label>
              <div class="relative">
                <input
                  type="text"
                  id="searchAsset"
                  class="w-full pl-10 pr-4 py-3 bg-white/10 backdrop-blur-sm border border-white/20 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 text-white placeholder-slate-400 transition-all duration-300"
                  placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô..."
                  style="box-shadow: 0 0 20px rgba(6, 182, 212, 0.1)"
                />
                <svg
                  class="absolute left-3 top-3.5 w-4 h-4 text-slate-400"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                  ></path>
                </svg>
              </div>
            </div>

            <div>
              <label
                class="block text-sm font-medium text-slate-300 mb-3 flex items-center"
              >
                <svg
                  class="w-4 h-4 mr-2 text-cyan-400"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"
                  ></path>
                </svg>
                ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó
              </label>
              <select
                id="filterType"
                class="w-full px-4 py-3 bg-white/10 backdrop-blur-sm border border-white/20 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 text-white transition-all duration-300"
                style="box-shadow: 0 0 20px rgba(6, 182, 212, 0.1)"
              >
                <option value="" class="bg-slate-800 text-white">
                  ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                </option>
                <option value="Hardware" class="bg-slate-800 text-white">
                  Hardware
                </option>
                <option value="Software" class="bg-slate-800 text-white">
                  Software
                </option>
                <option value="Network" class="bg-slate-800 text-white">
                  Network
                </option>
                <option
                  value="People/Data/Docs"
                  class="bg-slate-800 text-white"
                >
                  People/Data/Docs
                </option>
              </select>
            </div>

            <div>
              <label
                class="block text-sm font-medium text-slate-300 mb-3 flex items-center"
              >
                <svg
                  class="w-4 h-4 mr-2 text-red-400"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"
                  ></path>
                </svg>
                ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á
              </label>
              <select
                id="filterRisk"
                class="w-full px-4 py-3 bg-white/10 backdrop-blur-sm border border-white/20 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 text-white transition-all duration-300"
                style="box-shadow: 0 0 20px rgba(6, 182, 212, 0.1)"
              >
                <option value="" class="bg-slate-800 text-white">
                  ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                </option>
                <option value="‡∏™‡∏π‡∏á" class="bg-slate-800 text-white">‡∏™‡∏π‡∏á</option>
                <option value="‡∏Å‡∏•‡∏≤‡∏á" class="bg-slate-800 text-white">
                  ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á
                </option>
                <option value="‡∏ï‡πà‡∏≥" class="bg-slate-800 text-white">‡∏ï‡πà‡∏≥</option>
              </select>
            </div>

            <div>
              <label
                class="block text-sm font-medium text-slate-300 mb-3 flex items-center"
              >
                <svg
                  class="w-4 h-4 mr-2 text-cyan-400"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"
                  ></path>
                </svg>
                ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
              </label>
              <select
                id="filterStatus"
                class="w-full px-4 py-3 bg-white/10 backdrop-blur-sm border border-white/20 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 text-white transition-all duration-300"
                style="box-shadow: 0 0 20px rgba(6, 182, 212, 0.1)"
              >
                <option value="" class="bg-slate-800 text-white">
                  ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                </option>
                <option value="‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô" class="bg-slate-800 text-white">
                  ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
                </option>
                <option value="‡∏™‡∏≥‡∏£‡∏≠‡∏á" class="bg-slate-800 text-white">
                  ‡∏™‡∏≥‡∏£‡∏≠‡∏á
                </option>
                <option value="‡∏ä‡∏≥‡∏£‡∏∏‡∏î" class="bg-slate-800 text-white">
                  ‡∏ä‡∏≥‡∏£‡∏∏‡∏î
                </option>
                <option value="‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°" class="bg-slate-800 text-white">
                  ‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°
                </option>
                <option value="‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô" class="bg-slate-800 text-white">
                  ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
                </option>
              </select>
            </div>
          </div>
        </div>

        <!-- Loading Indicator -->
        <div id="loadingIndicator" class="hidden text-center py-12">
          <div
            class="inline-flex items-center justify-center w-16 h-16 bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 mb-4"
          >
            <div
              class="loading inline-block w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full"
            ></div>
          </div>
          <p class="text-gray-600 font-medium">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
        </div>

        <!-- Modern Assets Grid/Table -->
        <div
          id="assetsTableContainer"
          class="bg-white/10 backdrop-blur-md rounded-2xl shadow-2xl border border-white/20 overflow-hidden glow-card relative z-10"
        >
          <!-- Table Header -->
          <div
            class="bg-gradient-to-r from-slate-800/50 to-slate-700/50 backdrop-blur-md px-6 py-4 border-b border-white/20"
          >
            <div class="flex items-center justify-between">
              <h3 class="text-xl font-bold text-white flex items-center">
                <div
                  class="bg-gradient-to-r from-blue-500 to-purple-500 p-2 rounded-lg mr-3 shadow-lg shadow-blue-500/30"
                >
                  <svg
                    class="w-5 h-5 text-white"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"
                    ></path>
                  </svg>
                </div>
                ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô
              </h3>
              <div class="flex items-center space-x-3">
                <button
                  onclick="toggleView('table')"
                  id="tableViewBtn"
                  class="view-btn active px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 bg-gradient-to-r from-cyan-500 to-blue-500 text-white border border-cyan-400/30 shadow-lg shadow-cyan-500/20"
                >
                  <svg
                    class="w-4 h-4 mr-1"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M3 10h18M3 6h18m-9 8h9"
                    ></path>
                  </svg>
                  ‡∏ï‡∏≤‡∏£‡∏≤‡∏á
                </button>
                <button
                  onclick="toggleView('grid')"
                  id="gridViewBtn"
                  class="view-btn px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 bg-white/10 backdrop-blur-sm text-slate-300 border border-white/20 hover:bg-white/20"
                >
                  <svg
                    class="w-4 h-4 mr-1"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"
                    ></path>
                  </svg>
                  ‡∏Å‡∏≤‡∏£‡πå‡∏î
                </button>
              </div>
            </div>
          </div>

          <!-- Table View -->
          <div id="tableView" class="overflow-x-auto">
            <table class="w-full">
              <thead
                class="bg-gradient-to-r from-slate-800/50 to-slate-700/50 backdrop-blur-md"
              >
                <tr>
                  <th
                    class="px-6 py-4 text-left text-xs font-bold text-slate-300 uppercase tracking-wider"
                  >
                    ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó
                  </th>
                  <th
                    class="px-6 py-4 text-left text-xs font-bold text-slate-300 uppercase tracking-wider"
                  >
                    ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
                  </th>
                  <th
                    class="px-6 py-4 text-left text-xs font-bold text-slate-300 uppercase tracking-wider"
                  >
                    ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç
                  </th>
                  <th
                    class="px-6 py-4 text-left text-xs font-bold text-slate-300 uppercase tracking-wider"
                  >
                    ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á
                  </th>
                  <th
                    class="px-6 py-4 text-left text-xs font-bold text-slate-300 uppercase tracking-wider"
                  >
                    ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
                  </th>
                  <th
                    class="px-6 py-4 text-left text-xs font-bold text-slate-300 uppercase tracking-wider"
                  >
                    ‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö
                  </th>
                  <th
                    class="px-6 py-4 text-left text-xs font-bold text-slate-300 uppercase tracking-wider"
                  >
                    ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà
                  </th>
                  <th
                    class="px-6 py-4 text-left text-xs font-bold text-slate-300 uppercase tracking-wider"
                  >
                    ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£
                  </th>
                </tr>
              </thead>
              <tbody
                id="assetsTableBody"
                class="bg-white/5 backdrop-blur-sm divide-y divide-white/10"
              ></tbody>
            </table>
          </div>

          <!-- Grid View -->
          <div id="gridView" class="hidden p-6">
            <div
              id="assetsGridBody"
              class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"
            ></div>
          </div>

          <!-- Pagination -->
          <div id="paginationContainer"></div>
        </div>
      </div>

      <!-- Reports Section -->
      <div
        id="reports"
        class="section ml-0 lg:ml-72 pt-20 px-4 md:px-6 lg:px-8 py-8 bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 min-h-screen relative overflow-hidden"
        style="display: none"
      >
        <!-- Tech Background Effects -->
        <div class="absolute inset-0 opacity-20">
          <div
            class="absolute top-20 left-20 w-96 h-96 bg-blue-500/20 rounded-full blur-3xl animate-pulse"
          ></div>
          <div
            class="absolute bottom-20 right-20 w-80 h-80 bg-purple-500/20 rounded-full blur-3xl animate-pulse"
            style="animation-delay: 2s"
          ></div>
          <div
            class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-cyan-500/20 rounded-full blur-3xl animate-pulse"
            style="animation-delay: 4s"
          ></div>
        </div>

        <!-- Grid Pattern Overlay -->
        <div
          class="absolute inset-0 opacity-10"
          style="
            background-image: radial-gradient(
              circle at 1px 1px,
              rgba(255, 255, 255, 0.3) 1px,
              transparent 0
            );
            background-size: 20px 20px;
          "
        ></div>

        <div class="relative z-10">
          <h2
            class="text-4xl font-bold bg-gradient-to-r from-cyan-400 via-blue-400 to-purple-400 bg-clip-text text-transparent mb-2 drop-shadow-lg"
          >
            ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô
          </h2>
          <p class="text-slate-300 text-lg mb-8">
            ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô
          </p>

          <!-- Report Filters -->
          <div
            class="bg-white/10 backdrop-blur-md p-6 rounded-2xl shadow-2xl border border-white/20 mb-8 glow-card"
          >
            <div class="flex items-center justify-between mb-6">
              <h3 class="text-xl font-bold text-white flex items-center">
                <div
                  class="bg-gradient-to-r from-purple-500 to-blue-500 p-2 rounded-lg mr-3 shadow-lg shadow-purple-500/30"
                >
                  <svg
                    class="w-5 h-5 text-white"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.707A1 1 0 013 7V4z"
                    ></path>
                  </svg>
                </div>
                ‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô
              </h3>
              <button
                onclick="clearReportFilters()"
                class="text-sm text-slate-300 hover:text-white flex items-center bg-white/10 backdrop-blur-sm px-3 py-2 rounded-lg border border-white/20 hover:bg-white/20 transition-all duration-200"
              >
                <svg
                  class="w-4 h-4 mr-1"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"
                  ></path>
                </svg>
                ‡∏•‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á
              </button>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <div>
                <label
                  class="block text-sm font-medium text-slate-300 mb-3 flex items-center"
                >
                  <svg
                    class="w-4 h-4 mr-2 text-cyan-400"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"
                    ></path>
                  </svg>
                  ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå
                </label>
                <select
                  id="reportFilterType"
                  class="w-full px-4 py-3 bg-white/10 backdrop-blur-sm border border-white/20 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 text-white transition-all duration-300"
                  style="box-shadow: 0 0 20px rgba(6, 182, 212, 0.1)"
                  onchange="updateReportCounts()"
                >
                  <option value="" class="bg-slate-800 text-white">
                    ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                  </option>
                  <option value="Hardware" class="bg-slate-800 text-white">
                    Hardware
                  </option>
                  <option value="Software" class="bg-slate-800 text-white">
                    Software
                  </option>
                  <option value="Network" class="bg-slate-800 text-white">
                    Network
                  </option>
                  <option
                    value="People/Data/Docs"
                    class="bg-slate-800 text-white"
                  >
                    People/Data/Docs
                  </option>
                </select>
              </div>

              <div>
                <label
                  class="block text-sm font-medium text-slate-300 mb-3 flex items-center"
                >
                  <svg
                    class="w-4 h-4 mr-2 text-red-400"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"
                    ></path>
                  </svg>
                  ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á
                </label>
                <select
                  id="reportFilterRisk"
                  class="w-full px-4 py-3 bg-white/10 backdrop-blur-sm border border-white/20 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 text-white transition-all duration-300"
                  style="box-shadow: 0 0 20px rgba(6, 182, 212, 0.1)"
                  onchange="updateReportCounts()"
                >
                  <option value="" class="bg-slate-800 text-white">
                    ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                  </option>
                  <option value="‡∏™‡∏π‡∏á" class="bg-slate-800 text-white">
                    ‡∏™‡∏π‡∏á
                  </option>
                  <option value="‡∏Å‡∏•‡∏≤‡∏á" class="bg-slate-800 text-white">
                    ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á
                  </option>
                  <option value="‡∏ï‡πà‡∏≥" class="bg-slate-800 text-white">
                    ‡∏ï‡πà‡∏≥
                  </option>
                </select>
              </div>

              <div>
                <label
                  class="block text-sm font-medium text-slate-300 mb-3 flex items-center"
                >
                  <svg
                    class="w-4 h-4 mr-2 text-cyan-400"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"
                    ></path>
                  </svg>
                  ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
                </label>
                <select
                  id="reportFilterStatus"
                  class="w-full px-4 py-3 bg-white/10 backdrop-blur-sm border border-white/20 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 text-white transition-all duration-300"
                  style="box-shadow: 0 0 20px rgba(6, 182, 212, 0.1)"
                  onchange="updateReportCounts()"
                >
                  <option value="" class="bg-slate-800 text-white">
                    ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                  </option>
                  <option value="‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô" class="bg-slate-800 text-white">
                    ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
                  </option>
                  <option value="‡∏™‡∏≥‡∏£‡∏≠‡∏á" class="bg-slate-800 text-white">
                    ‡∏™‡∏≥‡∏£‡∏≠‡∏á
                  </option>
                  <option value="‡∏ä‡∏≥‡∏£‡∏∏‡∏î" class="bg-slate-800 text-white">
                    ‡∏ä‡∏≥‡∏£‡∏∏‡∏î
                  </option>
                  <option value="‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°" class="bg-slate-800 text-white">
                    ‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°
                  </option>
                  <option value="‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô" class="bg-slate-800 text-white">
                    ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
                  </option>
                </select>
              </div>
            </div>

            <!-- Filter Summary -->
            <div
              class="mt-6 p-4 bg-white/5 backdrop-blur-sm rounded-xl border border-white/10"
            >
              <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4 text-sm text-slate-300">
                  <span>‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏á:</span>
                  <span id="filteredCount" class="text-cyan-400 font-bold"
                    >0 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</span
                  >
                  <span>‡∏à‡∏≤‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span>
                  <span id="totalCount" class="text-white font-bold"
                    >0 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</span
                  >
                </div>
                <div class="text-xs text-slate-400" id="filterDescription">
                  ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                </div>
              </div>
            </div>
          </div>

          <!-- Export Cards -->
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
            <!-- Filtered Report Card -->
            <div
              class="group relative bg-white/10 backdrop-blur-md p-6 rounded-2xl border border-cyan-500/30 shadow-2xl shadow-cyan-500/20 hover:shadow-cyan-500/40 transition-all duration-500 hover:scale-105 overflow-hidden glow-card"
            >
              <div
                class="absolute inset-0 bg-gradient-to-br from-cyan-500/20 via-blue-500/10 to-transparent"
              ></div>
              <div class="relative z-10">
                <h3 class="text-xl font-bold text-white mb-4 flex items-center">
                  <div
                    class="bg-cyan-500/20 backdrop-blur-sm p-2 rounded-lg mr-3 border border-cyan-400/30 shadow-lg shadow-cyan-500/20"
                  >
                    <svg
                      class="w-5 h-5 text-cyan-300"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.707A1 1 0 013 7V4z"
                      ></path>
                    </svg>
                  </div>
                  ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á
                </h3>
                <p class="text-slate-300 mb-6">
                  ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏≤‡∏°‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å<br /><span
                    id="filteredReportCount"
                    class="text-cyan-400 font-bold"
                    >0</span
                  >
                  ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
                </p>
                <div class="space-y-3">
                  <button
                    onclick="exportFilteredReport('excel')"
                    class="w-full bg-gradient-to-r from-green-500 to-emerald-600 text-white py-3 rounded-xl hover:from-green-600 hover:to-emerald-700 transition-all duration-300 hover:scale-105 shadow-lg shadow-green-500/30 flex items-center justify-center"
                  >
                    <svg
                      class="w-5 h-5 mr-2"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
                      ></path>
                    </svg>
                    Export Excel
                  </button>
                  <!--<button onclick="exportFilteredReport('pdf')" class="w-full bg-gradient-to-r from-red-500 to-red-600 text-white py-3 rounded-xl hover:from-red-600 hover:to-red-700 transition-all duration-300 hover:scale-105 shadow-lg shadow-red-500/30 flex items-center justify-center">
                                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                    </svg>
                                    üìÑ Export PDF
                                </button>-->
                </div>
              </div>
            </div>

            <!-- Special Reports Card -->
            <div
              class="group relative bg-white/10 backdrop-blur-md p-6 rounded-2xl border border-purple-500/30 shadow-2xl shadow-purple-500/20 hover:shadow-purple-500/40 transition-all duration-500 hover:scale-105 overflow-hidden glow-card"
            >
              <div
                class="absolute inset-0 bg-gradient-to-br from-purple-500/20 via-violet-500/10 to-transparent"
              ></div>
              <div class="relative z-10">
                <h3 class="text-xl font-bold text-white mb-4 flex items-center">
                  <div
                    class="bg-purple-500/20 backdrop-blur-sm p-2 rounded-lg mr-3 border border-purple-400/30 shadow-lg shadow-purple-500/20"
                  >
                    <svg
                      class="w-5 h-5 text-purple-300"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
                      ></path>
                    </svg>
                  </div>
                  ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©
                </h3>
                <p class="text-slate-300 mb-6">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏à‡∏≤‡∏∞‡∏à‡∏á‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</p>
                <div class="space-y-3">
                  <button
                    onclick="exportReport('high-risk', 'excel')"
                    class="w-full bg-gradient-to-r from-red-500 to-pink-600 text-white py-2.5 rounded-lg hover:from-red-600 hover:to-pink-700 transition-all duration-300 hover:scale-105 shadow-lg shadow-red-500/30 flex items-center justify-center text-sm"
                  >
                    <svg
                      class="w-4 h-4 mr-2"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"
                      ></path>
                    </svg>
                    ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏á (<span id="highRiskReportCount">0</span>)
                  </button>
                  <button
                    onclick="exportReport('expiry', 'excel')"
                    class="w-full bg-gradient-to-r from-orange-500 to-amber-600 text-white py-2.5 rounded-lg hover:from-orange-600 hover:to-amber-700 transition-all duration-300 hover:scale-105 shadow-lg shadow-orange-500/30 flex items-center justify-center text-sm"
                  >
                    <svg
                      class="w-4 h-4 mr-2"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"
                      ></path>
                    </svg>
                    ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ (<span id="expiryReportCount">0</span>)
                  </button>
                  <button
                    onclick="exportReport('all', 'excel')"
                    class="w-full bg-gradient-to-r from-emerald-500 to-green-600 text-white py-2.5 rounded-lg hover:from-emerald-600 hover:to-green-700 transition-all duration-300 hover:scale-105 shadow-lg shadow-emerald-500/30 flex items-center justify-center text-sm"
                  >
                    <svg
                      class="w-4 h-4 mr-2"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
                      ></path>
                    </svg>
                    ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (<span id="allAssetsReportCount">0</span>)
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- View Asset Modal -->
    <div
      id="viewAssetModal"
      class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50 p-4"
    >
      <div
        class="bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-screen overflow-y-auto"
      >
        <div class="p-6">
          <div class="flex justify-between items-center mb-6">
            <h3 class="text-2xl font-bold text-gray-800 flex items-center">
              <svg
                class="w-6 h-6 mr-3 text-blue-600"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"
                ></path>
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"
                ></path>
              </svg>
              ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô
            </h3>
            <button
              id="closeViewModal"
              class="text-gray-400 hover:text-gray-600 transition-colors duration-200"
            >
              <svg
                class="w-6 h-6"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M6 18L18 6M6 6l12 12"
                ></path>
              </svg>
            </button>
          </div>

          <div id="viewAssetContent" class="space-y-6">
            <!-- Content will be populated by JavaScript -->
          </div>

          <div class="flex justify-end space-x-4 pt-6 border-t border-gray-200">
            <button
              id="closeViewModalBtn"
              class="px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition duration-200"
            >
              ‡∏õ‡∏¥‡∏î
            </button>
            <button
              id="editFromViewBtn"
              class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition duration-200 hidden"
            >
              ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Asset Modal -->
    <div
      id="assetModal"
      class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 hidden"
    >
      <div
        class="bg-white rounded-xl shadow-2xl w-full max-w-[90%] md:max-w-xl lg:max-w-3xl flex flex-col max-h-[90vh]"
      >
        <div
          class="bg-blue-50/50 backdrop-blur-sm border-b border-gray-200 px-6 py-4 flex justify-between items-center flex-shrink-0 rounded-t-xl"
        >
          <h3
            id="modalTitle"
            class="text-xl sm:text-2xl font-bold text-gray-800 flex items-center gap-2"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="w-6 h-6 text-blue-700"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M12 4v16m8-8H4"
              />
            </svg>
            ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå
          </h3>
          <button
            type="button"
            id="closeModal"
            class="text-gray-500 hover:text-gray-700 transition-all duration-200 p-1 rounded-full hover:bg-white"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="w-6 h-6"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"
              />
            </svg>
          </button>
        </div>

        <div class="flex-grow p-6 overflow-y-auto">
          <form id="assetForm" class="space-y-6">
            <div
              class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-x-6 gap-y-4"
            >
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1"
                  >‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå *</label
                >
                <select
                  id="assetType"
                  required
                  class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition shadow-sm"
                >
                  <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</option>
                  <option>Hardware</option>
                  <option>Software</option>
                  <option>Network</option>
                  <option>People/Data/Docs</option>
                </select>
              </div>
              <div class="lg:col-span-2">
                <label class="block text-sm font-medium text-gray-700 mb-1"
                  >‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå *</label
                >
                <input
                  type="text"
                  id="assetName"
                  placeholder="‡πÄ‡∏ä‡πà‡∏ô Server HOSxP"
                  required
                  class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition shadow-sm"
                />
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1"
                  >‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç *</label
                >
                <select
                  id="assetCritical"
                  required
                  class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 shadow-sm"
                >
                  <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</option>
                  <option>‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</option>
                  <option>‡πÑ‡∏°‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</option>
                </select>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1"
                  >‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á *</label
                >
                <select
                  id="assetRisk"
                  required
                  class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 shadow-sm"
                >
                  <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á</option>
                  <option>‡∏™‡∏π‡∏á</option>
                  <option>‡∏Å‡∏•‡∏≤‡∏á</option>
                  <option>‡∏ï‡πà‡∏≥</option>
                </select>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1"
                  >‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ *</label
                >
                <select
                  id="assetStatus"
                  required
                  class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 shadow-sm"
                >
                  <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</option>
                  <option>‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</option>
                  <option>‡∏™‡∏≥‡∏£‡∏≠‡∏á</option>
                  <option>‡∏ä‡∏≥‡∏£‡∏∏‡∏î</option>
                  <option>‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°</option>
                  <option>‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</option>
                </select>
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1"
                  >‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡∏ã‡∏∑‡πâ‡∏≠</label
                >
                <input
                  type="date"
                  id="assetPurchaseDate"
                  class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 shadow-sm"
                />
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1"
                  >‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏</label
                >
                <input
                  type="date"
                  id="assetExpiryDate"
                  readonly
                  class="w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed shadow-sm"
                />
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1"
                  >‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á</label
                >
                <input
                  type="date"
                  id="assetInstallDate"
                  class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 shadow-sm"
                />
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1"
                  >‡∏≠‡∏≤‡∏¢‡∏∏‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (‡∏õ‡∏µ)</label
                >
                <input
                  type="number"
                  id="assetLifespan"
                  placeholder="‡πÄ‡∏ä‡πà‡∏ô 5"
                  min="1"
                  class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 shadow-sm"
                />
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1"
                  >‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</label
                >
                <input
                  type="number"
                  id="assetBudgetYear"
                  placeholder="‡πÄ‡∏ä‡πà‡∏ô 2567"
                  min="2500"
                  max="2600"
                  class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 shadow-sm"
                />
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1"
                  >‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå</label
                >
                <input
                  type="text"
                  id="assetRegistrationNumber"
                  placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ó‡∏î 0000-000-0000-00/00"
                  class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 shadow-sm"
                />
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1"
                  >‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö *</label
                >
                <input
                  type="text"
                  id="assetOwner"
                  placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö"
                  required
                  class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 shadow-sm"
                />
              </div>
              <div class="lg:col-span-2">
                <label class="block text-sm font-medium text-gray-700 mb-1"
                  >‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á</label
                >
                <input
                  type="text"
                  id="assetLocation"
                  placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏´‡πâ‡∏≠‡∏á Server"
                  class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 shadow-sm"
                />
              </div>

              <div class="lg:col-span-3">
                <label class="block text-sm font-medium text-gray-700 mb-1"
                  >‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≥‡πÄ‡∏û‡∏≤‡∏∞</label
                >
                <textarea
                  id="assetSpecifications"
                  rows="2"
                  placeholder="‡πÄ‡∏ä‡πà‡∏ô CPU: Intel i7, RAM: 16GB, Storage: 1TB SSD"
                  class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 shadow-sm"
                ></textarea>
              </div>

              <div class="lg:col-span-3">
                <label class="block text-sm font-medium text-gray-700 mb-1"
                  >‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</label
                >
                <textarea
                  id="assetNotes"
                  rows="2"
                  placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°"
                  class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 shadow-sm"
                ></textarea>
              </div>
            </div>
          </form>
        </div>

        <div
          class="bg-blue-50 px-6 py-4 flex justify-end space-x-4 border-t border-blue-100 rounded-b-xl flex-shrink-0"
        >
          <button
            type="button"
            id="cancelBtn"
            class="px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100 transition duration-200"
          >
            ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
          </button>
          <button
            type="submit"
            form="assetForm"
            id="submitBtn"
            class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition duration-200 shadow-md"
          >
            ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
          </button>
        </div>
      </div>
    </div>

    <script>
      // Supabase Configuration
      const SUPABASE_URL = "https://dkruajnyjpduoukiyxlr.supabase.co";
      const SUPABASE_ANON_KEY =
        "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRrcnVham55anBkdW91a2l5eGxyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE5NTY0NzUsImV4cCI6MjA2NzUzMjQ3NX0.gNuCS20MYcYQCXumimA03gzFs8Vifh7Kepcd2u3rKiA";

      let supabase;
      let isSupabaseConnected = false;

      // Global variables
      let currentUser = null;
      let userRole = null;
      let assets = [];
      let editingAssetId = null;

      // Empty sample data - system starts with clean database
      const sampleAssets = [];

      // Initialize Supabase with enhanced connection
      async function initSupabase() {
        try {
          updateConnectionStatus(
            "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö Real-time...",
            "bg-blue-600"
          );

          supabase = window.supabase.createClient(
            SUPABASE_URL,
            SUPABASE_ANON_KEY
          );

          // Create table if it doesn't exist
          await createAssetsTableIfNotExists();

          // Test connection and load data
          const { data, error } = await supabase
            .from("assets")
            .select("*")
            .order("created_at", { ascending: false });

          if (error && error.code === "PGRST116") {
            // Table doesn't exist, create it
            await createAssetsTableIfNotExists();
            isSupabaseConnected = true;
            updateConnectionStatus("‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô", "bg-green-600");
            updateDbStatus("‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
          } else if (error) {
            throw error;
          } else {
            isSupabaseConnected = true;
            assets = data || [];
            updateConnectionStatus(
              `‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ${assets.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à`,
              "bg-green-600"
            );
            updateDbStatus(`‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ${assets.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`);

            // Setup real-time subscription
            setupRealTimeSubscription();
          }

          // Migrate localStorage data to Supabase if exists
          await migrateLocalDataToSupabase();
        } catch (error) {
          console.error("Supabase connection error:", error);
          isSupabaseConnected = false;
          updateConnectionStatus("‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á", "bg-yellow-600");
          updateDbStatus("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ - ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á");

          // Load from localStorage as fallback
          loadFromLocalStorage();
        }
      }

      // Create assets table with proper structure
      async function createAssetsTableIfNotExists() {
        try {
          // Try to create table with SQL
          const { error } = await supabase.rpc("exec_sql", {
            sql: `
                        CREATE TABLE IF NOT EXISTS assets (
                            id SERIAL PRIMARY KEY,
                            type VARCHAR(50) NOT NULL,
                            name VARCHAR(255) NOT NULL,
                            critical VARCHAR(20) NOT NULL,
                            risk VARCHAR(20) NOT NULL,
                            status VARCHAR(50) NOT NULL,
                            purchase_date DATE,
                            lifespan INT, -- ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå ‡∏≠‡∏≤‡∏¢‡∏∏‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (‡∏õ‡∏µ)
                            expiry_date DATE,
                            budget_year INTEGER,
                            registration_number VARCHAR(100),
                            specifications TEXT,
                            owner VARCHAR(255) NOT NULL,
                            location VARCHAR(255),
                            notes TEXT,
                            created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
                            updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
                        );
                        
                        -- Enable Row Level Security
                        ALTER TABLE assets ENABLE ROW LEVEL SECURITY;
                        
                        -- Create policy to allow all operations for now (can be restricted later)
                        CREATE POLICY IF NOT EXISTS "Allow all operations" ON assets FOR ALL USING (true);
                        
                        -- Create updated_at trigger
                        CREATE OR REPLACE FUNCTION update_updated_at_column()
                        RETURNS TRIGGER AS $$
                        BEGIN
                            NEW.updated_at = NOW();
                            RETURN NEW;
                        END;
                        $$ language 'plpgsql';
                        
                        DROP TRIGGER IF EXISTS update_assets_updated_at ON assets;
                        CREATE TRIGGER update_assets_updated_at
                            BEFORE UPDATE ON assets
                            FOR EACH ROW
                            EXECUTE FUNCTION update_updated_at_column();
                    `,
          });

          if (error) {
            console.log(
              "Table creation via RPC failed, will be created automatically:",
              error.message
            );
          }

          return true;
        } catch (error) {
          console.log(
            "Table will be created automatically when first asset is added"
          );
          return true;
        }
      }

      // Setup real-time subscription for live sync
      function setupRealTimeSubscription() {
        if (!isSupabaseConnected) return;

        try {
          // Subscribe to changes in assets table
          const subscription = supabase
            .channel("assets_changes")
            .on(
              "postgres_changes",
              {
                event: "*",
                schema: "public",
                table: "assets",
              },
              (payload) => {
                console.log("Real-time update received:", payload);
                handleRealTimeUpdate(payload);
              }
            )
            .subscribe((status) => {
              console.log("Real-time subscription status:", status);
              if (status === "SUBSCRIBED") {
                //showNotification('Sync ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô', 'success');
              }
            });

          // Store subscription for cleanup
          window.assetsSubscription = subscription;
        } catch (error) {
          console.error("Failed to setup real-time subscription:", error);
        }
      }

      // Handle real-time updates
      function handleRealTimeUpdate(payload) {
        const { eventType, new: newRecord, old: oldRecord } = payload;

        switch (eventType) {
          case "INSERT":
            // Add new asset if not already exists
            if (!assets.find((a) => a.id === newRecord.id)) {
              assets.unshift(newRecord);
              showNotification(`‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà: ${newRecord.name}`, "success");
              updateAllSections();
            }
            break;

          case "UPDATE":
            // Update existing asset
            const updateIndex = assets.findIndex((a) => a.id === newRecord.id);
            if (updateIndex !== -1) {
              assets[updateIndex] = newRecord;
              showNotification(`‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: ${newRecord.name}`, "success");
              updateAllSections();
            }
            break;

          case "DELETE":
            // Remove deleted asset
            const deleteIndex = assets.findIndex((a) => a.id === oldRecord.id);
            if (deleteIndex !== -1) {
              const deletedAsset = assets[deleteIndex];
              assets.splice(deleteIndex, 1);
              showNotification(`‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: ${deletedAsset.name}`, "success");
              updateAllSections();
            }
            break;
        }
      }

      // Migrate localStorage data to Supabase
      async function migrateLocalDataToSupabase() {
        if (!isSupabaseConnected) return;

        try {
          const localData = localStorage.getItem("itAssets");
          if (!localData) return;

          const localAssets = JSON.parse(localData);
          if (!localAssets || localAssets.length === 0) return;

          // Check if we already have data in Supabase
          const { data: existingData } = await supabase
            .from("assets")
            .select("id")
            .limit(1);

          if (existingData && existingData.length > 0) {
            // Data already exists in Supabase, don't migrate
            console.log("Data already exists in Supabase, skipping migration");
            return;
          }

          // Migrate local data to Supabase
          const migrateData = localAssets.map((asset) => ({
            type: asset.type,
            name: asset.name,
            critical: asset.critical,
            risk: asset.risk,
            status: asset.status,
            purchase_date: asset.purchase_date,
            expiry_date: asset.expiry_date,
            install_date: asset.install_date, // ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ
            budget_year: asset.budget_year,
            registration_number: asset.registration_number,
            specifications: asset.specifications,
            owner: asset.owner,
            location: asset.location,
            notes: asset.notes,
            created_at: asset.created_at || new Date().toISOString(),
            updated_at: asset.updated_at || new Date().toISOString(),
          }));

          const { data, error } = await supabase
            .from("assets")
            .insert(migrateData)
            .select();

          if (error) throw error;

          // Update local assets array
          assets = data;

          // Clear localStorage after successful migration
          localStorage.removeItem("itAssets");

          showNotification(
            `‡∏¢‡πâ‡∏≤‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ${data.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à`,
            "success"
          );
          updateAllSections();
        } catch (error) {
          console.error("Migration failed:", error);
          showNotification(
            "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πâ‡∏≤‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ - ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ï‡πà‡∏≠‡πÑ‡∏õ",
            "error"
          );
        }
      }

      // Manual table creation function
      async function createTableManually() {
        try {
          updateConnectionStatus("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏ï‡∏≤‡∏£‡∏≤‡∏á...", "bg-blue-600");

          // Table will be created automatically when first asset is added
          updateConnectionStatus("‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô", "bg-green-600");
          showNotification(
            "‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô - ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡∏•‡πà‡∏≤",
            "success"
          );

          return true;
        } catch (error) {
          console.error("Table preparation failed:", error);
          showNotification(
            "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÑ‡∏î‡πâ: " + error.message,
            "error"
          );
          return false;
        }
      }

      // Update connection status
      function updateConnectionStatus(message, bgClass) {
        const statusElement = document.getElementById("connectionStatus");
        const statusText = document.getElementById("statusText");

        statusText.textContent = message;
        statusElement.className = `fixed top-0 left-0 right-0 z-50 ${bgClass} text-white text-center py-2 text-sm`;

        // Update sync status in header
        updateSyncStatus(message, bgClass);

        // Hide status after 3 seconds if successful
        if (bgClass === "bg-green-600") {
          setTimeout(() => {
            statusElement.style.display = "none";
          }, 3000);
        }
      }

      // Update sync status in header
      function updateSyncStatus(message, bgClass) {
        const syncStatus = document.getElementById("syncStatus");
        const syncStatusText = document.getElementById("syncStatusText");

        if (!syncStatus || !syncStatusText) return;

        syncStatus.classList.remove("hidden");

        if (bgClass === "bg-green-600") {
          syncStatusText.textContent = isSupabaseConnected
            ? "‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå"
            : "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á";
          syncStatus.className = `hidden md:flex items-center space-x-2 bg-white/10 backdrop-blur-md px-4 py-2 rounded-xl border ${
            isSupabaseConnected
              ? "border-green-500/30 shadow-lg shadow-green-500/20 glow-border-green"
              : "border-yellow-500/30 shadow-lg shadow-yellow-500/20 glow-border-yellow"
          }`;

          const dot = syncStatus.querySelector(".w-2.h-2");
          if (dot) {
            dot.className = `w-2 h-2 ${
              isSupabaseConnected ? "bg-green-400" : "bg-yellow-400"
            } rounded-full animate-pulse shadow-lg ${
              isSupabaseConnected
                ? "shadow-green-400/50"
                : "shadow-yellow-400/50"
            }`;
          }

          const text = syncStatus.querySelector("span");
          if (text) {
            text.className = `text-sm ${
              isSupabaseConnected ? "text-green-300" : "text-yellow-300"
            } font-medium`;
          }
        } else if (bgClass === "bg-yellow-600") {
          syncStatusText.textContent = "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á";
          syncStatus.className =
            "hidden md:flex items-center space-x-2 bg-white/10 backdrop-blur-md px-4 py-2 rounded-xl border border-yellow-500/30 shadow-lg shadow-yellow-500/20 glow-border-yellow";
        } else {
          syncStatusText.textContent = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠...";
          syncStatus.className =
            "hidden md:flex items-center space-x-2 bg-white/10 backdrop-blur-md px-4 py-2 rounded-xl border border-cyan-500/30 shadow-lg shadow-cyan-500/20 glow-border";
        }
      }

      // Update database status in login screen
      function updateDbStatus(message) {
        const dbStatus = document.getElementById("dbStatus");
        dbStatus.textContent = message;
        dbStatus.className = isSupabaseConnected
          ? "mt-2 text-xs text-green-600"
          : "mt-2 text-xs text-yellow-600";
      }

      // Load assets from Supabase
      async function loadAssetsFromSupabase() {
        if (!isSupabaseConnected) return;

        try {
          showLoading(true);
          const { data, error } = await supabase
            .from("assets")
            .select("*")
            .order("created_at", { ascending: false });

          if (error) throw error;

          assets = data || [];

          // Update all sections with loaded data
          updateAllSections();
        } catch (error) {
          console.error("Error loading assets:", error);
          showNotification("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•", "error");
        } finally {
          showLoading(false);
        }
      }

      // Save asset to Supabase
      async function saveAssetToSupabase(assetData, isEdit = false) {
        try {
          let result;

          if (isSupabaseConnected) {
            // Use Supabase
            if (isEdit) {
              // First check if the record exists
              const { data: existingData, error: checkError } = await supabase
                .from("assets")
                .select("id")
                .eq("id", editingAssetId)
                .single();

              if (checkError) {
                console.error("Record check error:", checkError);
                throw new Error("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç");
              }

              // Update the record
              const { data, error } = await supabase
                .from("assets")
                .update({
                  type: assetData.type,
                  name: assetData.name,
                  critical: assetData.critical,
                  risk: assetData.risk,
                  status: assetData.status,
                  purchase_date: assetData.purchase_date,
                  lifespan: assetData.lifespan, // ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
                  expiry_date: assetData.expiry_date,
                  install_date: assetData.install_date, // ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
                  budget_year: assetData.budget_year,
                  registration_number: assetData.registration_number,
                  specifications: assetData.specifications,
                  owner: assetData.owner,
                  location: assetData.location,
                  notes: assetData.notes,
                  updated_at: new Date().toISOString(),
                })
                .eq("id", editingAssetId)
                .select();

              if (error) {
                console.error("Update error:", error);
                throw error;
              }

              if (!data || data.length === 0) {
                throw new Error("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ");
              }

              result = data[0]; // Get first result instead of using .single()

              // Update local array
              const index = assets.findIndex((a) => a.id === editingAssetId);
              if (index !== -1) {
                assets[index] = result;
              }
            } else {
              const { data, error } = await supabase
                .from("assets")
                .insert([
                  {
                    type: assetData.type,
                    name: assetData.name,
                    critical: assetData.critical,
                    risk: assetData.risk,
                    status: assetData.status,
                    purchase_date: assetData.purchase_date,
                    lifespan: assetData.lifespan, // ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
                    expiry_date: assetData.expiry_date,
                    install_date: assetData.install_date, // ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
                    budget_year: assetData.budget_year,
                    registration_number: assetData.registration_number,
                    specifications: assetData.specifications,
                    owner: assetData.owner,
                    location: assetData.location,
                    notes: assetData.notes,
                    created_at: new Date().toISOString(),
                    updated_at: new Date().toISOString(),
                  },
                ])
                .select();

              if (error) {
                console.error("Insert error:", error);
                throw error;
              }

              if (!data || data.length === 0) {
                throw new Error("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ");
              }

              result = data[0]; // Get first result instead of using .single()

              // Add to local array
              assets.unshift(result);
            }
          } else {
            // Fallback to localStorage
            if (isEdit) {
              const index = assets.findIndex((a) => a.id === editingAssetId);
              if (index !== -1) {
                assets[index] = {
                  ...assets[index],
                  ...assetData,
                  updated_at: new Date().toISOString(),
                };
                result = assets[index];
              } else {
                throw new Error("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç");
              }
            } else {
              const newId = Math.max(...assets.map((a) => a.id), 0) + 1;
              result = {
                id: newId,
                ...assetData,
                created_at: new Date().toISOString(),
                updated_at: new Date().toISOString(),
              };
              assets.unshift(result);
            }

            // Save to localStorage
            localStorage.setItem("itAssets", JSON.stringify(assets));
          }

          return result;
        } catch (error) {
          console.error("Error saving asset:", error);
          throw new Error("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ: " + error.message);
        }
      }

      // Delete asset from Supabase
      async function deleteAssetFromSupabase(id) {
        try {
          if (isSupabaseConnected) {
            // Delete from Supabase
            const { error } = await supabase
              .from("assets")
              .delete()
              .eq("id", id);

            if (error) throw error;

            // Remove from local array
            assets = assets.filter((a) => a.id !== id);
          } else {
            // Remove from local array only
            const initialLength = assets.length;
            assets = assets.filter((a) => a.id !== id);

            if (assets.length === initialLength) {
              throw new Error("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö");
            }

            // Save to localStorage
            localStorage.setItem("itAssets", JSON.stringify(assets));
          }
        } catch (error) {
          console.error("Error deleting asset:", error);
          throw new Error("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ: " + error.message);
        }
      }

      // Fallback local storage functions
      function saveAssetLocally(assetData, isEdit) {
        if (isEdit) {
          const index = assets.findIndex((a) => a.id === editingAssetId);
          assets[index] = { ...assets[index], ...assetData };
          return assets[index];
        } else {
          const newId = Math.max(...assets.map((a) => a.id), 0) + 1;
          const newAsset = {
            id: newId,
            ...assetData,
            created_at: new Date().toISOString(),
          };
          assets.push(newAsset);
          return newAsset;
        }
      }

      // Show loading indicator
      function showLoading(show) {
        const loadingIndicator = document.getElementById("loadingIndicator");
        if (show) {
          loadingIndicator.classList.remove("hidden");
        } else {
          loadingIndicator.classList.add("hidden");
        }
      }

      // Show notification
      function showNotification(message, type = "info") {
        const notification = document.createElement("div");
        notification.className = `fixed top-16 right-4 z-50 p-4 rounded-lg shadow-lg text-white ${
          type === "error"
            ? "bg-red-600"
            : type === "success"
            ? "bg-green-600"
            : "bg-blue-600"
        }`;
        notification.textContent = message;

        document.body.appendChild(notification);

        setTimeout(() => {
          notification.remove();
        }, 3000);
      }

      // Load data from localStorage
      function loadFromLocalStorage() {
        try {
          const savedAssets = localStorage.getItem("itAssets");
          if (savedAssets) {
            assets = JSON.parse(savedAssets);
            console.log("‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å localStorage:", assets.length, "‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£");
          } else {
            // Start with empty database
            assets = [];
            localStorage.setItem("itAssets", JSON.stringify(assets));
            console.log("‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡∏•‡πà‡∏≤");
          }
        } catch (error) {
          console.error("Error loading from localStorage:", error);
          assets = [];
        }
      }

      // Real-time data synchronization
      function setupRealTimeSync() {
        // Update all sections every time data changes
        const originalPush = Array.prototype.push;
        const originalSplice = Array.prototype.splice;
        const originalPop = Array.prototype.pop;

        // Override array methods to trigger updates
        Object.defineProperty(assets, "push", {
          value: function (...items) {
            const result = originalPush.apply(this, items);
            updateAllSections();
            return result;
          },
        });

        // Auto-save to localStorage when data changes
        setInterval(() => {
          if (!isSupabaseConnected && assets.length > 0) {
            localStorage.setItem("itAssets", JSON.stringify(assets));
          }
        }, 5000); // Auto-save every 5 seconds
      }

      // Mobile menu functionality
      function toggleMobileMenu() {
        const sidebar = document.getElementById("sidebar");
        const isOpen = sidebar.classList.contains("translate-x-0");

        if (isOpen) {
          sidebar.classList.remove("translate-x-0");
          sidebar.classList.add("-translate-x-full");
        } else {
          sidebar.classList.remove("-translate-x-full");
          sidebar.classList.add("translate-x-0");
        }
      }

      // Close mobile menu when clicking outside
      function closeMobileMenuOnOutsideClick(e) {
        const sidebar = document.getElementById("sidebar");
        const mobileMenuBtn = document.getElementById("mobileMenuBtn");

        if (!sidebar.contains(e.target) && !mobileMenuBtn.contains(e.target)) {
          if (window.innerWidth < 1024) {
            // lg breakpoint
            sidebar.classList.remove("translate-x-0");
            sidebar.classList.add("-translate-x-full");
          }
        }
      }

      // Authentication functions (Supabase version)
      async function login(username, password) {
        try {
          if (!supabase) {
            await initSupabase();
          }

          // üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏à‡∏≤‡∏Å Supabase
          const { data: user, error } = await supabase
            .from("users")
            .select("id, username, password, role, display_name")
            .eq("username", username)
            .eq("password", password) // ‚ö†Ô∏è plain-text ‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ï‡∏Å‡∏•‡∏á
            .maybeSingle();

          if (error || !user) {
            return false;
          }

          // ‚úÖ ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö
          currentUser = user.username;
          userRole = user.role;

          // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á sessionStorage
          sessionStorage.setItem("currentUser", currentUser);
          sessionStorage.setItem("userRole", userRole);
          sessionStorage.setItem(
            "displayName",
            user.display_name || currentUser
          );
          sessionStorage.setItem(
            "displayRole",
            user.role === "admin" ? "‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö" : "‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô"
          );

          // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï UI ‡∏ï‡∏≤‡∏°‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó
          updateUserInterface();
          updateMenuByRole(userRole);

          // ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤ Main App
          document.getElementById("loginScreen").classList.add("hidden");
          document.getElementById("mainApp").classList.remove("hidden");

          // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞ sync
          setTimeout(() => {
            updateAllSections();
            setupRealTimeSync();
          }, 100);

          return true;
        } catch (err) {
          console.error("Login error:", err);
          return false;
        }
      }

      function logout() {
        // Cleanup real-time subscription
        if (window.assetsSubscription) {
          window.assetsSubscription.unsubscribe();
          window.assetsSubscription = null;
        }

        // Clear all session data
        sessionStorage.removeItem("currentUser");
        sessionStorage.removeItem("userRole");
        sessionStorage.removeItem("displayName");
        sessionStorage.removeItem("displayRole");

        // Reset variables
        currentUser = null;
        userRole = null;
        assets = [];

        // Show login screen
        document.getElementById("mainApp").classList.add("hidden");
        document.getElementById("loginScreen").classList.remove("hidden");

        // Reset form
        document.getElementById("loginForm").reset();
        document.getElementById("loginError").classList.add("hidden");

        // Reset login button state
        const loginBtn = document.getElementById("loginBtn");
        if (loginBtn) {
          loginBtn.disabled = false;
          loginBtn.innerHTML = "‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö";
        }

        // Reset sync status
        const syncStatus = document.getElementById("syncStatus");
        if (syncStatus) {
          syncStatus.classList.add("hidden");
        }

        showNotification("‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢", "success");
      }

      function checkSession() {
        const savedUser = sessionStorage.getItem("currentUser");
        const savedRole = sessionStorage.getItem("userRole");
        const displayName = sessionStorage.getItem("displayName");
        const displayRole = sessionStorage.getItem("displayRole");

        if (savedUser && savedRole) {
          currentUser = savedUser;
          userRole = savedRole;

          // ‚úÖ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï UI ‡πÅ‡∏•‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
          updateUserInterface();
          updateRoleBasedAccess();
          updateMenuByRole(userRole); // üîπ ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á

          return true;
        }
        return false;
      }

      function updateUserInterface() {
        if (!currentUser) return;

        const displayName =
          sessionStorage.getItem("displayName") || currentUser;
        const displayRole =
          sessionStorage.getItem("displayRole") ||
          (userRole === "admin" ? "‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö" : "‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô");

        // Update header
        document.getElementById("currentUserName").textContent = displayName;
        document.getElementById("currentUserRole").textContent = displayRole;
        document.getElementById("headerUsername").textContent = currentUser;

        // Update dropdown
        document.getElementById("dropdownUserName").textContent = displayName;
        document.getElementById("dropdownUserRole").textContent = displayRole;

        // ‚úÖ ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏î‡πâ‡∏ß‡∏¢
        updateRoleBasedAccess();
      }

      function updateRoleBasedAccess() {
        const isAdmin = userRole === "admin";

        // Add/Edit buttons
        const addAssetBtn = document.getElementById("addAssetBtn");
        if (addAssetBtn) {
          addAssetBtn.style.display = isAdmin ? "block" : "none";
        }

        // Edit/Delete buttons in table will be handled in renderTableView
        // Modal submit button will be handled in openAddAssetModal
      }

      // Initialize app
      document.addEventListener("DOMContentLoaded", async function () {
        console.log("DOM Content Loaded - Initializing app...");

        const loginBtn = document.getElementById("loginBtn");
        if (loginBtn) {
          loginBtn.disabled = false;
          loginBtn.innerHTML = "‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö";
        }
        // Load data from localStorage first
        loadFromLocalStorage();

        // Initialize Supabase (but use localStorage for demo)
        await initSupabase();

        // Check for existing session
        if (checkSession()) {
          // User is already logged in
          document.getElementById("loginScreen").classList.add("hidden");
          document.getElementById("mainApp").classList.remove("hidden");

          // Initialize all sections
          setTimeout(() => {
            updateAllSections();
            setupRealTimeSync();
          }, 100);
        } else {
          // Show login screen
          document.getElementById("loginScreen").classList.remove("hidden");
          document.getElementById("mainApp").classList.add("hidden");
        }

        // Login form
        const loginForm = document.getElementById("loginForm");
        if (loginForm) {
          loginForm.addEventListener("submit", handleLogin);
        }

        // Toggle password visibility
        const togglePassword = document.getElementById("togglePassword");
        if (togglePassword) {
          togglePassword.addEventListener("click", function () {
            const passwordInput = document.getElementById("password");
            const type =
              passwordInput.getAttribute("type") === "password"
                ? "text"
                : "password";
            passwordInput.setAttribute("type", type);

            // Toggle icon
            const icon = this.querySelector("svg");
            if (type === "text") {
              icon.innerHTML = `
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"></path>
                        `;
            } else {
              icon.innerHTML = `
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                        `;
            }
          });
        }

        // User menu dropdown
        const userMenuBtn = document.getElementById("userMenuBtn");
        const userDropdown = document.getElementById("userDropdown");
        if (userMenuBtn && userDropdown) {
          userMenuBtn.addEventListener("click", function (e) {
            e.stopPropagation();
            userDropdown.classList.toggle("hidden");
          });

          // Close dropdown when clicking outside
          document.addEventListener("click", function () {
            userDropdown.classList.add("hidden");
          });
        }

        // Mobile menu button
        const mobileMenuBtn = document.getElementById("mobileMenuBtn");
        if (mobileMenuBtn) {
          mobileMenuBtn.addEventListener("click", toggleMobileMenu);
        }

        // Close mobile menu on outside click
        document.addEventListener("click", closeMobileMenuOnOutsideClick);

        // Close mobile menu on window resize
        window.addEventListener("resize", function () {
          const sidebar = document.getElementById("sidebar");
          if (window.innerWidth >= 1024) {
            // lg breakpoint
            sidebar.classList.remove("-translate-x-full");
            sidebar.classList.add("translate-x-0");
          } else {
            sidebar.classList.remove("translate-x-0");
            sidebar.classList.add("-translate-x-full");
          }
        });

        const addAssetBtn = document.getElementById("addAssetBtn");
        if (addAssetBtn) {
          addAssetBtn.addEventListener("click", openAddAssetModal);
        }

        const closeModal = document.getElementById("closeModal");
        if (closeModal) {
          closeModal.addEventListener("click", closeAssetModal);
        }

        const cancelBtn = document.getElementById("cancelBtn");
        if (cancelBtn) {
          cancelBtn.addEventListener("click", closeAssetModal);
        }

        // View Asset Modal
        const closeViewModal = document.getElementById("closeViewModal");
        if (closeViewModal) {
          closeViewModal.addEventListener("click", closeViewAssetModal);
        }

        const closeViewModalBtn = document.getElementById("closeViewModalBtn");
        if (closeViewModalBtn) {
          closeViewModalBtn.addEventListener("click", closeViewAssetModal);
        }

        const editFromViewBtn = document.getElementById("editFromViewBtn");
        if (editFromViewBtn) {
          editFromViewBtn.addEventListener("click", function () {
            const assetId = this.dataset.assetId;
            closeViewAssetModal();
            editAsset(parseInt(assetId));
          });
        }

        const assetForm = document.getElementById("assetForm");
        if (assetForm) {
          assetForm.addEventListener("submit", handleAssetSubmit);
        }

        // Navigation
        document.querySelectorAll(".tech-nav-btn").forEach((btn) => {
          btn.addEventListener("click", function () {
            const section = this.dataset.section;
            showSection(section);
          });
        });

        // Update system time
        function updateSystemTime() {
          const now = new Date();
          const timeString = now.toLocaleTimeString("th-TH", {
            hour: "2-digit",
            minute: "2-digit",
            second: "2-digit",
          });
          const systemTimeElement = document.getElementById("systemTime");
          if (systemTimeElement) {
            systemTimeElement.textContent = timeString;
          }
        }

        // Update time every second
        setInterval(updateSystemTime, 1000);
        updateSystemTime();

        // Filters
        const searchAsset = document.getElementById("searchAsset");
        if (searchAsset) {
          searchAsset.addEventListener("input", filterAssets);
        }

        const filterType = document.getElementById("filterType");
        if (filterType) {
          filterType.addEventListener("change", filterAssets);
        }

        const filterRisk = document.getElementById("filterRisk");
        if (filterRisk) {
          filterRisk.addEventListener("change", filterAssets);
        }

        const filterStatus = document.getElementById("filterStatus");
        if (filterStatus) {
          filterStatus.addEventListener("change", filterAssets);
        }

        // Modal click outside to close
        const assetModal = document.getElementById("assetModal");
        if (assetModal) {
          assetModal.addEventListener("click", function (e) {
            if (e.target === this) {
              closeAssetModal();
            }
          });
        }

        const viewAssetModal = document.getElementById("viewAssetModal");
        if (viewAssetModal) {
          viewAssetModal.addEventListener("click", function (e) {
            if (e.target === this) {
              closeViewAssetModal();
            }
          });
        }

        console.log("App initialization complete");
      });

      // Handle login form submission
      async function handleLogin(e) {
        e.preventDefault();

        const username = document.getElementById("username").value.trim();
        const password = document.getElementById("password").value;
        const loginBtn = document.getElementById("loginBtn");
        const loginError = document.getElementById("loginError");

        // ‡∏ã‡πà‡∏≠‡∏ô error ‡πÄ‡∏î‡∏¥‡∏°
        loginError.classList.add("hidden");

        // ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÇ‡∏´‡∏•‡∏î
        const originalText = loginBtn.innerHTML;
        loginBtn.innerHTML = `
        <div class="relative z-10 flex items-center justify-center space-x-2">
            <div class="loading inline-block w-4 h-4 border-2 border-white border-t-transparent rounded-full"></div>
            <span>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö...</span>
        </div>
    `;
        loginBtn.disabled = true;

        try {
          const success = await login(username, password); // ‚úÖ ‡πÉ‡∏ä‡πâ await

          if (success) {
            // ‚úÖ ‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡πÇ‡∏´‡∏•‡∏î‡∏à‡∏≤‡∏Å Supabase ‡∏Å‡πà‡∏≠‡∏ô
            if (isSupabaseConnected) {
              try {
                await loadAssetsFromSupabase();
                showNotification("‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Supabase ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à", "success");
              } catch (err) {
                console.warn(
                  "Supabase load failed, fallback to localStorage:",
                  err
                );
                loadFromLocalStorage();
                showNotification(
                  "‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Supabase ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‚Üí ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å localStorage",
                  "warning"
                );
              }
            } else {
              loadFromLocalStorage();
              showNotification("‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å localStorage", "info");
            }

            // ‚úÖ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Dashboard + sync
            updateAllSections();
            setupRealTimeSync();
          } else {
            // ‚ùå Login ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß
            loginError.classList.remove("hidden");
            document.getElementById("password").value = "";
          }
        } catch (err) {
          console.error("Login process error:", err);
          showNotification("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö", "error");
        } finally {
          // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏õ‡∏∏‡πà‡∏°
          loginBtn.innerHTML = originalText;
          loginBtn.disabled = false;
        }
      }

      // Sync data
      async function handleSync() {
        try {
          showLoading(true);

          if (isSupabaseConnected) {
            // Reload from Supabase
            await loadAssetsFromSupabase();
            showNotification(
              "‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Supabase ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à - ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• " +
                assets.length +
                " ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£",
              "success"
            );
          } else {
            // Reload from localStorage
            loadFromLocalStorage();
            showNotification(
              "‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à - ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• " +
                assets.length +
                " ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£",
              "success"
            );

            // Update all sections with synced data
            updateAllSections();
          }
        } catch (error) {
          console.error("Sync error:", error);
          showNotification(
            "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: " + error.message,
            "error"
          );
        } finally {
          showLoading(false);
        }
      }

      // Navigation
      function showSection(sectionName) {
        console.log("Switching to section:", sectionName);

        // Hide all sections
        document.querySelectorAll(".section").forEach((section) => {
          section.classList.remove("active");
          section.style.display = "none";
        });

        // Show selected section
        const targetSection = document.getElementById(sectionName);
        if (targetSection) {
          targetSection.style.display = "block";
          targetSection.classList.add("active");
        }

        // Update navigation buttons
        document.querySelectorAll(".tech-nav-btn").forEach((btn) => {
          btn.classList.remove("active");
        });

        const activeBtn = document.querySelector(
          `[data-section="${sectionName}"]`
        );
        if (activeBtn) {
          activeBtn.classList.add("active");
        }

        // Update content based on section - refresh all data
        updateAllSections();
      }

      // Update all sections with current data
      function updateAllSections() {
        updateDashboard();
        renderAssetsTable();
        updateSidebarStats();
        updateReportsData();
      }

      // Dashboard
      function updateDashboard() {
        const stats = {
          hardware: assets.filter((a) => a.type === "Hardware").length,
          software: assets.filter((a) => a.type === "Software").length,
          network: assets.filter((a) => a.type === "Network").length,
          data: assets.filter((a) => a.type === "People/Data/Docs").length,
          highRisk: assets.filter((a) => a.risk === "‡∏™‡∏π‡∏á").length,
          mediumRisk: assets.filter((a) => a.risk === "‡∏Å‡∏•‡∏≤‡∏á").length,
          lowRisk: assets.filter((a) => a.risk === "‡∏ï‡πà‡∏≥").length,
        };

        // Animate counters
        animateCounter("hardwareCount", stats.hardware);
        animateCounter("softwareCount", stats.software);
        animateCounter("networkCount", stats.network);
        animateCounter("dataCount", stats.data);
        animateCounter("highRiskCount", stats.highRisk);
        animateCounter("mediumRiskCount", stats.mediumRisk);
        animateCounter("lowRiskCount", stats.lowRisk);

        // Update last update time
        document.getElementById(
          "lastUpdate"
        ).textContent = `‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: ${new Date().toLocaleTimeString(
          "th-TH"
        )}`;

        // Update sidebar stats
        updateSidebarStats();

        // Generate repair status list
        const repairList = document.getElementById("repairList");
        const repairBadge = document.getElementById("repairBadge");
        const repairAssets = assets.filter(
          (asset) => asset.status === "‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°"
        );

        repairBadge.textContent = repairAssets.length;

        if (repairAssets.length > 0) {
          repairList.innerHTML = repairAssets
            .map(
              (asset) => `
            <div class="flex items-start p-4 bg-gradient-to-r from-orange-50 to-red-50 border-l-4 border-orange-500 rounded-lg shadow-sm hover:shadow-md transition-all duration-200">
                <div class="bg-orange-500 p-2 rounded-lg mr-3 mt-0.5 shadow-lg">
                    <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                    </svg>
                </div>
                <div class="flex-1">
                    <p class="font-semibold text-sm text-orange-800">${
                      asset.name
                    }</p>
                    <p class="text-xs text-orange-600 mt-1">${asset.owner} | ${
                asset.location || "‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà"
              }</p>
                    ${
                      asset.notes
                        ? `<p class="text-xs text-orange-700 mt-2 bg-white/50 p-2 rounded border">${asset.notes}</p>`
                        : ""
                    }
                    <div class="flex items-center mt-2 text-xs text-orange-500">
                        <svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                        </svg>
                        <span>‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°</span>
                    </div>
                </div>
                <button onclick="viewAsset(${
                  asset.id
                })" class="ml-2 p-2 bg-orange-100 hover:bg-orange-200 text-orange-600 rounded-lg transition-all duration-200 hover:scale-110" title="‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                    </svg>
                </button>
            </div>
        `
            )
            .join("");
        } else {
          repairList.innerHTML = `
            <div class="flex items-center justify-center py-8 text-gray-400">
                <div class="text-center">
                    <svg class="w-12 h-12 mx-auto mb-3 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <p class="text-sm">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°</p>
                    <p class="text-xs mt-1">‡∏ó‡∏∏‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥</p>
                </div>
            </div>
        `;
        }

        // Generate alerts
        const alertsList = document.getElementById("alertsList");
        const alertBadge = document.getElementById("alertBadge");
        const today = new Date();
        const warningDays = 60;

        const alerts = assets.filter((asset) => {
          let alertByNoteOrRisk =
            (asset.notes &&
              (asset.notes.includes("‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏") ||
                asset.notes.includes("> 5 ‡∏õ‡∏µ"))) ||
            asset.risk === "‡∏™‡∏π‡∏á";

          let alertByExpiry = false;
          if (asset.expiry_date) {
            const expiryDate = new Date(asset.expiry_date);
            const diffTime = expiryDate - today;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            if (diffDays < 0 || diffDays <= warningDays) {
              alertByExpiry = true;
            }
          }

          return alertByNoteOrRisk || alertByExpiry;
        });

        alertBadge.textContent = alerts.length;

        if (alerts.length > 0) {
          alertsList.innerHTML = alerts
            .map((asset) => {
              let type = "note";
              let message = asset.notes || "";

              if (asset.risk === "‡∏™‡∏π‡∏á") {
                type = "risk";
                message = "‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏á - ‡∏Ñ‡∏ß‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏î‡∏π‡πÅ‡∏•‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©";
              }

              if (asset.expiry_date) {
                const expiryDate = new Date(asset.expiry_date);
                const diffDays = Math.ceil(
                  (expiryDate - today) / (1000 * 60 * 60 * 24)
                );
                if (diffDays < 0) {
                  type = "expired";
                  message = "‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÅ‡∏•‡πâ‡∏ß";
                } else if (diffDays <= warningDays) {
                  type = "expiring";
                  message = `‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡∏≠‡∏µ‡∏Å <span class="expiring-days" data-expiry="${expiryDate.getTime()}">${diffDays}</span> ‡∏ß‡∏±‡∏ô`;
                }
              }

              // UI Styles
              let style = {
                bg: "bg-yellow-100 border-l-4 border-yellow-500",
                iconBg: "bg-yellow-500",
                text: "text-yellow-700",
                iconPath: "M12 9v2m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z",
              };

              if (type === "risk") {
                style = {
                  bg: "bg-red-100 border-l-4 border-red-600",
                  iconBg: "bg-red-600",
                  text: "text-red-700",
                  iconPath: "M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z",
                };
              } else if (type === "expired") {
                style = {
                  bg: "bg-red-200 border-l-4 border-red-700",
                  iconBg: "bg-red-700",
                  text: "text-red-800",
                  iconPath: "M6 18L18 6M6 6l12 12",
                };
              } else if (type === "expiring") {
                style = {
                  bg: "bg-yellow-200 border-l-4 border-yellow-600",
                  iconBg: "bg-yellow-600",
                  text: "text-yellow-800",
                  iconPath: "M12 6v6l4 2",
                };
              } else if (type === "note") {
                style = {
                  bg: "bg-orange-100 border-l-4 border-orange-500",
                  iconBg: "bg-orange-500",
                  text: "text-orange-700",
                  iconPath: "M12 8v4l3 3",
                };
              }

              return `
                <div class="flex items-start p-3 rounded-lg ${style.bg}">
                    <div class="${style.iconBg} p-1.5 rounded-lg mr-3 mt-0.5">
                        <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="${style.iconPath}" />
                        </svg>
                    </div>
                    <div class="flex-1">
                        <p class="font-semibold text-sm ${style.text}">${asset.name}</p>
                        <p class="text-xs ${style.text} mt-1">${message}</p>
                    </div>
                    <button onclick="viewAsset(${asset.id})" class="ml-2 p-2 bg-white/50 hover:bg-gray-100 ${style.text} rounded-lg transition-all duration-200 hover:scale-110" title="‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                        </svg>
                    </button>
                </div>
            `;
            })
            .join("");
        } else {
          alertsList.innerHTML = `
            <div class="flex items-center justify-center py-8 text-gray-400">
                <div class="text-center">
                    <svg class="w-12 h-12 mx-auto mb-3 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <p class="text-sm">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</p>
                    <p class="text-xs mt-1">‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥</p>
                </div>
            </div>
        `;
        }
        function updateExpiringDays() {
          const now = new Date();
          document.querySelectorAll(".expiring-days").forEach((el) => {
            const expiryMs = Number(el.getAttribute("data-expiry"));
            const expiryDate = new Date(expiryMs);
            const diffTime = expiryDate - now;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

            if (diffDays <= 0) {
              // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô "‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÅ‡∏•‡πâ‡∏ß"
              el.parentElement.textContent = "‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÅ‡∏•‡πâ‡∏ß";
              const card = el.closest(".flex.items-start");
              if (card) {
                card.className =
                  "flex items-start p-3 rounded-lg bg-red-200 border-l-4 border-red-700";
              }
            } else {
              // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà
              el.textContent = diffDays;
            }
          });
        }

        // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ó‡∏±‡∏ô‡∏ó‡∏µ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á
        updateExpiringDays();

        // ‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏´‡πâ‡πÄ‡∏ä‡πá‡∏Ñ‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô (‡∏ó‡∏∏‡∏Å 1 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏Å‡πá‡πÑ‡∏î‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏±‡∏ß‡∏£‡πå)
        setInterval(updateExpiringDays, 60 * 60 * 1000); // ‡∏ó‡∏∏‡∏Å 1 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á
      }

      // Animate counter function
      function animateCounter(elementId, targetValue) {
        const element = document.getElementById(elementId);
        if (!element) return;

        const currentValue = parseInt(element.textContent) || 0;
        const increment = targetValue > currentValue ? 1 : -1;
        const duration = 1000; // 1 second
        const steps = Math.abs(targetValue - currentValue);
        const stepDuration = steps > 0 ? duration / steps : 0;

        if (steps === 0) return;

        let current = currentValue;
        const timer = setInterval(() => {
          current += increment;
          element.textContent = current;

          if (current === targetValue) {
            clearInterval(timer);
          }
        }, stepDuration);
      }

      // Update sidebar stats
      function updateSidebarStats() {
        const totalAssets = assets.length;
        const highRiskAssets = assets.filter((a) => a.risk === "‡∏™‡∏π‡∏á").length;
        const activeAssets = assets.filter((a) => a.status === "‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô").length;

        animateCounter("sidebarTotalAssets", totalAssets);
        animateCounter("sidebarHighRisk", highRiskAssets);
        animateCounter("sidebarActive", activeAssets);
      }

      // Update reports data
      function updateReportsData() {
        // Update report statistics in real-time
        const allAssetsCount = assets.length;
        const highRiskCount = assets.filter((a) => a.risk === "‡∏™‡∏π‡∏á").length;
        const expiryCount = getExpiryAssets().length;
        const alertsCount = assets.filter(
          (a) =>
            (a.notes &&
              (a.notes.includes("‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏") || a.notes.includes("> 7 ‡∏õ‡∏µ"))) ||
            a.risk === "‡∏™‡∏π‡∏á"
        ).length;

        // Update report counts in the UI
        const allAssetsReportCount = document.getElementById(
          "allAssetsReportCount"
        );
        if (allAssetsReportCount) {
          allAssetsReportCount.textContent = allAssetsCount;
        }

        const highRiskReportCount = document.getElementById(
          "highRiskReportCount"
        );
        if (highRiskReportCount) {
          highRiskReportCount.textContent = highRiskCount;
        }

        const expiryReportCount = document.getElementById("expiryReportCount");
        if (expiryReportCount) {
          expiryReportCount.textContent = expiryCount;
        }

        // Update filtered report counts
        updateReportCounts();
      }

      // Get filtered assets for reports
      function getFilteredAssetsForReports() {
        const typeFilter =
          document.getElementById("reportFilterType")?.value || "";
        const riskFilter =
          document.getElementById("reportFilterRisk")?.value || "";
        const statusFilter =
          document.getElementById("reportFilterStatus")?.value || "";

        return assets.filter((asset) => {
          const matchesType = !typeFilter || asset.type === typeFilter;
          const matchesRisk = !riskFilter || asset.risk === riskFilter;
          const matchesStatus = !statusFilter || asset.status === statusFilter;

          return matchesType && matchesRisk && matchesStatus;
        });
      }

      // Update report counts based on filters
      function updateReportCounts() {
        const filteredAssets = getFilteredAssetsForReports();
        const totalAssets = assets.length;

        // Update filtered count
        const filteredCount = document.getElementById("filteredCount");
        const totalCount = document.getElementById("totalCount");
        const filteredReportCount = document.getElementById(
          "filteredReportCount"
        );
        const filterDescription = document.getElementById("filterDescription");

        if (filteredCount) filteredCount.textContent = filteredAssets.length;
        if (totalCount) totalCount.textContent = totalAssets;
        if (filteredReportCount)
          filteredReportCount.textContent = filteredAssets.length;

        // Update filter description
        if (filterDescription) {
          const typeFilter =
            document.getElementById("reportFilterType")?.value || "";
          const riskFilter =
            document.getElementById("reportFilterRisk")?.value || "";
          const statusFilter =
            document.getElementById("reportFilterStatus")?.value || "";

          let description = [];
          if (typeFilter) description.push(`‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó: ${typeFilter}`);
          if (riskFilter) description.push(`‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á: ${riskFilter}`);
          if (statusFilter) description.push(`‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ${statusFilter}`);

          filterDescription.textContent =
            description.length > 0
              ? description.join(", ")
              : "‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î";
        }
      }

      // Clear report filters
      function clearReportFilters() {
        document.getElementById("reportFilterType").value = "";
        document.getElementById("reportFilterRisk").value = "";
        document.getElementById("reportFilterStatus").value = "";
        updateReportCounts();
      }

      // Export filtered report
      function exportFilteredReport(format) {
        const filteredAssets = getFilteredAssetsForReports();
        const typeFilter =
          document.getElementById("reportFilterType")?.value || "";
        const riskFilter =
          document.getElementById("reportFilterRisk")?.value || "";
        const statusFilter =
          document.getElementById("reportFilterStatus")?.value || "";

        // Create report title based on filters
        let reportTitle = "‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô";
        let titleParts = [];

        if (typeFilter) titleParts.push(`‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó ${typeFilter}`);
        if (riskFilter) titleParts.push(`‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á${riskFilter}`);
        if (statusFilter) titleParts.push(`‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ ${statusFilter}`);

        if (titleParts.length > 0) {
          reportTitle += ` - ${titleParts.join(", ")}`;
        } else {
          reportTitle += " - ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î";
        }

        console.log("Export Filtered Report:", {
          format,
          filteredCount: filteredAssets.length,
          totalCount: assets.length,
          filters: { typeFilter, riskFilter, statusFilter },
          reportTitle,
        });

        if (filteredAssets.length === 0) {
          if (assets.length === 0) {
            showNotification(
              "‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö - ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö",
              "info"
            );
            createSampleDataForExport("filtered", format, reportTitle);
          } else {
            showNotification(
              `‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (‡∏à‡∏≤‡∏Å ${assets.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)`,
              "error"
            );
          }
          return;
        }

        if (format === "excel") {
          exportToExcel(filteredAssets, "filtered", reportTitle);
        } else if (format === "pdf") {
          exportToPDF(filteredAssets, "filtered", reportTitle);
        }
      }

      // Asset Management
      let currentView = "table";
      let currentPage = 1;
      const itemsPerPage = 10;

      function renderAssetsTable() {
        const filteredAssets = getFilteredAssets();
        updateAssetStats(filteredAssets);

        if (currentView === "table") {
          renderTableView(filteredAssets);
        } else {
          renderGridView(filteredAssets);
        }

        renderPagination(filteredAssets.length);
      }

      function getPaginatedAssets(assets) {
        const startIndex = (currentPage - 1) * itemsPerPage;
        const endIndex = startIndex + itemsPerPage;
        return assets.slice(startIndex, endIndex);
      }

      function renderPagination(totalItems) {
        const totalPages = Math.ceil(totalItems / itemsPerPage);
        const paginationContainer = document.getElementById(
          "paginationContainer"
        );

        if (totalPages <= 1) {
          paginationContainer.innerHTML = "";
          return;
        }

        let paginationHTML = `
                <div class="flex items-center justify-between mt-6 px-6 py-4 bg-white/5 backdrop-blur-sm border-t border-white/10">
                    <div class="flex items-center text-sm text-slate-300">
                        <span>‡πÅ‡∏™‡∏î‡∏á ${Math.min(
                          (currentPage - 1) * itemsPerPage + 1,
                          totalItems
                        )} - ${Math.min(
          currentPage * itemsPerPage,
          totalItems
        )} ‡∏à‡∏≤‡∏Å ${totalItems} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <button onclick="changePage(${currentPage - 1})" ${
          currentPage === 1 ? "disabled" : ""
        } 
                                class="px-3 py-2 text-sm font-medium text-slate-300 bg-white/10 backdrop-blur-sm border border-white/20 rounded-lg hover:bg-white/20 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                            </svg>
                        </button>
            `;

        // Page numbers
        for (let i = 1; i <= totalPages; i++) {
          if (
            i === 1 ||
            i === totalPages ||
            (i >= currentPage - 2 && i <= currentPage + 2)
          ) {
            paginationHTML += `
                        <button onclick="changePage(${i})" 
                                class="px-3 py-2 text-sm font-medium ${
                                  i === currentPage
                                    ? "text-white bg-gradient-to-r from-cyan-500 to-blue-600 border-cyan-500 shadow-lg shadow-cyan-500/30"
                                    : "text-slate-300 bg-white/10 backdrop-blur-sm border-white/20 hover:bg-white/20"
                                } 
                                border rounded-lg transition-all duration-200">
                            ${i}
                        </button>
                    `;
          } else if (i === currentPage - 3 || i === currentPage + 3) {
            paginationHTML += `<span class="px-2 text-slate-400">...</span>`;
          }
        }

        paginationHTML += `
                        <button onclick="changePage(${currentPage + 1})" ${
          currentPage === totalPages ? "disabled" : ""
        } 
                                class="px-3 py-2 text-sm font-medium text-slate-300 bg-white/10 backdrop-blur-sm border border-white/20 rounded-lg hover:bg-white/20 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            `;

        paginationContainer.innerHTML = paginationHTML;
      }

      function changePage(page) {
        const filteredAssets = getFilteredAssets();
        const totalPages = Math.ceil(filteredAssets.length / itemsPerPage);

        if (page < 1 || page > totalPages) return;

        currentPage = page;
        renderAssetsTable();

        // Scroll to top of table
        document.getElementById("assetsTableContainer").scrollIntoView({
          behavior: "smooth",
          block: "start",
        });
      }

      function renderTableView(filteredAssets) {
        const tbody = document.getElementById("assetsTableBody");

        if (filteredAssets.length === 0) {
          tbody.innerHTML = `
                    <tr>
                        <td colspan="8" class="px-6 py-12 text-center">
                            <div class="flex flex-col items-center justify-center text-gray-400">
                                <svg class="w-16 h-16 mb-4 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                </svg>
                                <p class="text-lg font-medium text-gray-500 mb-2">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</p>
                                <p class="text-sm text-gray-400 mb-4">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå‡πÅ‡∏£‡∏Å‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</p>
                                <button onclick="openAddAssetModal()" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition duration-200 flex items-center space-x-2">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                                    </svg>
                                    <span>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå‡πÅ‡∏£‡∏Å</span>
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
          return;
        }

        // Get paginated assets
        const paginatedAssets = getPaginatedAssets(filteredAssets);
        const startIndex = (currentPage - 1) * itemsPerPage;

        tbody.innerHTML = paginatedAssets
          .map(
            (asset, index) => `
                <tr class="hover:bg-gradient-to-r hover:from-white/95 hover:to-slate-50/95 hover:shadow-lg transition-all duration-300 group border-b border-white/10 hover:border-cyan-200/50">
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="inline-flex items-center px-3 py-2 rounded-lg text-sm font-semibold ${getTypeColor(
                          asset.type
                        )} shadow-sm group-hover:shadow-md transition-all duration-200">
                            ${asset.type}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div>
                            <div class="text-sm font-bold text-white group-hover:text-slate-800 transition-colors duration-200">${
                              asset.name
                            }</div>
                            <div class="text-xs text-slate-300 group-hover:text-slate-600 transition-colors duration-200">${
                              asset.registration_number ||
                              "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå"
                            }</div>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="inline-flex items-center px-3 py-2 rounded-lg text-sm font-semibold ${
                          asset.critical === "‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç"
                            ? "bg-red-100 text-red-800 border border-red-200"
                            : "bg-gray-100 text-gray-800 border border-gray-200"
                        } shadow-sm group-hover:shadow-md transition-all duration-200">
                            ${asset.critical}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="inline-flex items-center px-3 py-2 rounded-lg text-sm font-semibold ${getRiskColor(
                          asset.risk
                        )} shadow-sm border ${getRiskBorder(
              asset.risk
            )} group-hover:shadow-md transition-all duration-200">
                            ${asset.risk}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="inline-flex items-center px-3 py-2 rounded-lg text-sm font-semibold ${getStatusColor(
                          asset.status
                        )} shadow-sm border ${getStatusBorder(
              asset.status
            )} group-hover:shadow-md transition-all duration-200">
                            ${asset.status}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-white group-hover:text-slate-800 font-medium transition-colors duration-200">${
                      asset.owner
                    }</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-300 group-hover:text-slate-600 transition-colors duration-200">${
                      asset.location || "-"
                    }</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <div class="flex items-center space-x-3 opacity-70 group-hover:opacity-100 transition-opacity duration-200">
                            <button onclick="viewAsset(${
                              asset.id
                            })" class="bg-gradient-to-r from-cyan-500 to-blue-600 hover:from-cyan-600 hover:to-blue-700 text-white px-4 py-2 rounded-lg text-sm font-semibold transition-all duration-200 hover:scale-105 shadow-lg shadow-cyan-500/30 hover:shadow-cyan-500/50 flex items-center space-x-2">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                                </svg>
                                <span>‡∏î‡∏π</span>
                            </button>
                            ${
                              userRole === "admin"
                                ? `
                                <button onclick="editAsset(${asset.id})" class="bg-gradient-to-r from-emerald-500 to-green-600 hover:from-emerald-600 hover:to-green-700 text-white px-4 py-2 rounded-lg text-sm font-semibold transition-all duration-200 hover:scale-105 shadow-lg shadow-emerald-500/30 hover:shadow-emerald-500/50 flex items-center space-x-2">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                    </svg>
                                    <span>‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</span>
                                </button>
                            `
                                : ""
                            }
                        </div>
                    </td>
                </tr>
            `
          )
          .join("");
      }

      function renderGridView(filteredAssets) {
        const gridBody = document.getElementById("assetsGridBody");

        if (filteredAssets.length === 0) {
          gridBody.innerHTML = `
                    <div class="col-span-full flex flex-col items-center justify-center py-16 text-gray-400">
                        <svg class="w-20 h-20 mb-6 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                        <p class="text-xl font-medium text-gray-500 mb-3">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</p>
                        <p class="text-gray-400 mb-6">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå‡πÅ‡∏£‡∏Å‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</p>
                        <button onclick="openAddAssetModal()" class="bg-gradient-to-r from-blue-500 to-blue-600 text-white px-8 py-3 rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all duration-300 hover:scale-105 shadow-lg flex items-center space-x-3">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                            </svg>
                            <span class="font-medium">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå‡πÅ‡∏£‡∏Å</span>
                        </button>
                    </div>
                `;
          return;
        }

        // Get paginated assets
        const paginatedAssets = getPaginatedAssets(filteredAssets);

        gridBody.innerHTML = paginatedAssets
          .map(
            (asset) => `
                <div class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-white/20 p-6 hover:shadow-xl transition-all duration-300 hover:scale-105 group">
                    <!-- Asset Header -->
                    <div class="flex items-start justify-between mb-4">
                        <div class="flex items-center">
                            <div class="w-12 h-12 bg-gradient-to-r ${getTypeGradient(
                              asset.type
                            )} rounded-xl flex items-center justify-center mr-3 shadow-lg">
                                <span class="text-white text-xl">${getTypeIcon(
                                  asset.type
                                )}</span>
                            </div>
                            <div>
                                <h4 class="font-bold text-gray-900 text-sm">${
                                  asset.name
                                }</h4>
                                <p class="text-xs text-gray-500">${
                                  asset.type
                                }</p>
                            </div>
                        </div>
                        <div class="flex items-center space-x-1 opacity-0 group-hover:opacity-100 transition-opacity duration-200">
                            <button onclick="viewAsset(${
                              asset.id
                            })" class="p-2 bg-gray-100 hover:bg-gray-200 text-gray-600 rounded-lg transition-all duration-200 hover:scale-110" title="‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                                </svg>
                            </button>
                            ${
                              userRole === "admin"
                                ? `
                                <button onclick="editAsset(${asset.id})" class="p-2 bg-blue-100 hover:bg-blue-200 text-blue-600 rounded-lg transition-all duration-200 hover:scale-110" title="‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                    </svg>
                                </button>
                            `
                                : ""
                            }
                        </div>
                    </div>

                    <!-- Status Badges -->
                    <div class="flex flex-wrap gap-2 mb-4">
                        <span class="inline-flex items-center px-2.5 py-1 rounded-lg text-xs font-semibold ${getRiskColor(
                          asset.risk
                        )} border ${getRiskBorder(asset.risk)}">
                            ${getRiskIcon(asset.risk)} ${asset.risk}
                        </span>
                        <span class="inline-flex items-center px-2.5 py-1 rounded-lg text-xs font-semibold ${getStatusColor(
                          asset.status
                        )} border ${getStatusBorder(asset.status)}">
                            ${getStatusIcon(asset.status)} ${asset.status}
                        </span>
                        ${
                          asset.critical === "‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç"
                            ? `
                        <span class="inline-flex items-center px-2.5 py-1 rounded-lg text-xs font-semibold bg-red-100 text-red-800 border border-red-200">
                            ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç
                        </span>
                        `
                            : ""
                        }
                    </div>

                    <!-- Asset Details -->
                    <div class="space-y-3">
                        <div class="flex items-center text-sm">
                            <svg class="w-4 h-4 text-gray-400 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                            </svg>
                            <span class="text-gray-600">${asset.owner}</span>
                        </div>
                        
                        ${
                          asset.location
                            ? `
                        <div class="flex items-center text-sm">
                            <svg class="w-4 h-4 text-gray-400 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                            </svg>
                            <span class="text-gray-600">${asset.location}</span>
                        </div>
                        `
                            : ""
                        }
                        
                        ${
                          asset.registration_number
                            ? `
                        <div class="flex items-center text-sm">
                            <svg class="w-4 h-4 text-gray-400 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path>
                            </svg>
                            <span class="text-gray-600 font-mono text-xs">${asset.registration_number}</span>
                        </div>
                        `
                            : ""
                        }
                    </div>

                    ${
                      asset.notes
                        ? `
                    <div class="mt-4 p-3 bg-gray-50 rounded-lg border-l-4 ${
                      asset.risk === "‡∏™‡∏π‡∏á"
                        ? "border-red-400"
                        : "border-gray-300"
                    }">
                        <p class="text-xs text-gray-600">${asset.notes}</p>
                    </div>
                    `
                        : ""
                    }
                </div>
            `
          )
          .join("");
      }

      function updateAssetStats(filteredAssets) {
        const stats = {
          total: filteredAssets.length,
          active: filteredAssets.filter((a) => a.status === "‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô").length,
          highRisk: filteredAssets.filter((a) => a.risk === "‡∏™‡∏π‡∏á").length,
          repair: filteredAssets.filter((a) => a.status === "‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°").length,
        };

        animateCounter("totalAssetsCount", stats.total);
        animateCounter("activeAssetsCount", stats.active);
        animateCounter("highRiskAssetsCount", stats.highRisk);
        animateCounter("repairAssetsCount", stats.repair);
      }

      function toggleView(viewType) {
        currentView = viewType;

        // Update button states
        document
          .getElementById("tableViewBtn")
          .classList.toggle("active", viewType === "table");
        document
          .getElementById("gridViewBtn")
          .classList.toggle("active", viewType === "grid");

        // Show/hide views
        document
          .getElementById("tableView")
          .classList.toggle("hidden", viewType !== "table");
        document
          .getElementById("gridView")
          .classList.toggle("hidden", viewType !== "grid");

        // Re-render current view
        renderAssetsTable();
      }

      function clearFilters() {
        document.getElementById("searchAsset").value = "";
        document.getElementById("filterType").value = "";
        document.getElementById("filterRisk").value = "";
        document.getElementById("filterStatus").value = "";
        filterAssets();
      }

      function getFilteredAssets() {
        const search = document
          .getElementById("searchAsset")
          .value.toLowerCase();
        const typeFilter = document.getElementById("filterType").value;
        const riskFilter = document.getElementById("filterRisk").value;
        const statusFilter = document.getElementById("filterStatus").value;

        return assets.filter((asset) => {
          const matchesSearch =
            asset.name.toLowerCase().includes(search) ||
            asset.owner.toLowerCase().includes(search) ||
            (asset.registration_number &&
              asset.registration_number.toLowerCase().includes(search)) ||
            (asset.location && asset.location.toLowerCase().includes(search)); // ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ
          const matchesType = !typeFilter || asset.type === typeFilter;
          const matchesRisk = !riskFilter || asset.risk === riskFilter;
          const matchesStatus = !statusFilter || asset.status === statusFilter;

          return matchesSearch && matchesType && matchesRisk && matchesStatus;
        });
      }

      function getTypeGradient(type) {
        const gradients = {
          Hardware: "from-blue-500 to-blue-600",
          Software: "from-emerald-500 to-emerald-600",
          Network: "from-purple-500 to-purple-600",
          "People/Data/Docs": "from-orange-500 to-orange-600",
        };
        return gradients[type] || "from-gray-500 to-gray-600";
      }

      function getRiskBorder(risk) {
        const borders = {
          ‡∏™‡∏π‡∏á: "border-red-200",
          ‡∏Å‡∏•‡∏≤‡∏á: "border-yellow-200",
          ‡∏ï‡πà‡∏≥: "border-green-200",
        };
        return borders[risk] || "border-gray-200";
      }

      function getStatusBorder(status) {
        const borders = {
          ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô: "border-green-200",
          ‡∏™‡∏≥‡∏£‡∏≠‡∏á: "border-blue-200",
          ‡∏ä‡∏≥‡∏£‡∏∏‡∏î: "border-red-200",
          ‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°: "border-orange-200",
          ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô: "border-gray-200",
        };
        return borders[status] || "border-gray-200";
      }

      function filterAssets() {
        // Reset to first page when filtering
        currentPage = 1;

        // Re-render assets table with current filters
        renderAssetsTable();

        // Update dashboard with filtered data if needed
        // (Dashboard shows all data, but we could add filtered views later)
      }

      // Asset Modal
      function openAddAssetModal() {
        if (userRole !== "admin") {
          showNotification("‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•", "error");
          return;
        }

        editingAssetId = null;
        document.getElementById("modalTitle").textContent = "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå";
        document.getElementById("assetForm").reset();
        document.getElementById("assetModal").classList.remove("hidden");
        document.getElementById("assetModal").classList.add("flex");
      }

      function editAsset(id) {
        if (userRole !== "admin") {
          showNotification("‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•", "error");
          return;
        }

        const asset = assets.find((a) => a.id === id);
        if (!asset) return;

        editingAssetId = id;
        document.getElementById("modalTitle").textContent = "‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå";

        document.getElementById("assetType").value = asset.type;
        document.getElementById("assetName").value = asset.name;
        document.getElementById("assetCritical").value = asset.critical;
        document.getElementById("assetRisk").value = asset.risk;
        document.getElementById("assetStatus").value = asset.status;
        document.getElementById("assetPurchaseDate").value =
          asset.purchase_date || "";
        document.getElementById("assetExpiryDate").value =
          asset.expiry_date || "";
        document.getElementById("assetInstallDate").value =
          asset.install_date || "";
        document.getElementById("assetBudgetYear").value =
          asset.budget_year || "";
        document.getElementById("assetRegistrationNumber").value =
          asset.registration_number || "";
        document.getElementById("assetSpecifications").value =
          asset.specifications || "";
        document.getElementById("assetOwner").value = asset.owner;
        document.getElementById("assetLocation").value = asset.location || "";
        document.getElementById("assetNotes").value = asset.notes || "";

        document.getElementById("assetModal").classList.remove("hidden");
        document.getElementById("assetModal").classList.add("flex");
      }

      function viewAsset(id) {
        const asset = assets.find((a) => a.id === id);
        if (!asset) return;

        const content = document.getElementById("viewAssetContent");
        const editBtn = document.getElementById("editFromViewBtn");

        // Show edit button only for admin
        if (userRole === "admin") {
          editBtn.classList.remove("hidden");
          editBtn.dataset.assetId = id;
        } else {
          editBtn.classList.add("hidden");
        }

        content.innerHTML = `
                <!-- Asset Header -->
                <div class="bg-gradient-to-r ${getTypeGradient(
                  asset.type
                )} p-6 rounded-xl text-white mb-6">
                    <div class="flex items-center">
                        <div class="w-16 h-16 bg-white/20 backdrop-blur-sm rounded-xl flex items-center justify-center mr-4">
                            <span class="text-3xl">${getTypeIcon(
                              asset.type
                            )}</span>
                        </div>
                        <div>
                            <h2 class="text-2xl font-bold">${asset.name}</h2>
                            <p class="text-white/80">${asset.type}</p>
                        </div>
                    </div>
                </div>

                <!-- Status Badges -->
                <div class="flex flex-wrap gap-3 mb-6">
                    <span class="inline-flex items-center px-4 py-2 rounded-xl text-sm font-semibold ${getRiskColor(
                      asset.risk
                    )} border ${getRiskBorder(asset.risk)} shadow-sm">
                        ${getRiskIcon(asset.risk)} ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á : ${asset.risk}
                    </span>
                    <span class="inline-flex items-center px-4 py-2 rounded-xl text-sm font-semibold ${getStatusColor(
                      asset.status
                    )} border ${getStatusBorder(asset.status)} shadow-sm">
                        ${getStatusIcon(asset.status)} ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ : ${asset.status}
                    </span>
                    <span class="inline-flex items-center px-4 py-2 rounded-xl text-sm font-semibold ${
                      asset.critical === "‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç"
                        ? "bg-red-100 text-red-800 border border-red-200"
                        : "bg-gray-100 text-gray-800 border border-gray-200"
                    } shadow-sm">
                        ${asset.critical === "‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç" ? "" : ""} ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç : ${
          asset.critical
        }
                    </span>
                    ${(() => {
                      if (asset.expiry_date) {
                        const today = new Date();
                        const expiryDate = new Date(asset.expiry_date);
                        const diffDays = Math.ceil(
                          (expiryDate - today) / (1000 * 60 * 60 * 24)
                        );
                        if (diffDays < 0) {
                          return `
                <span class="inline-flex items-center px-4 py-2 rounded-xl text-sm font-semibold bg-red-100 text-red-800 border border-red-200 shadow-sm">
                    ‚ùå ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÅ‡∏•‡πâ‡∏ß
                </span>`;
                        } else if (diffDays <= 60) {
                          return `
                <span class="inline-flex items-center px-4 py-2 rounded-xl text-sm font-semibold bg-yellow-100 text-yellow-800 border border-yellow-300 shadow-sm">
                    ‚è≥ ‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡∏≠‡∏µ‡∏Å&nbsp;<span class="expiring-days" data-expiry="${expiryDate.getTime()}"> ${diffDays} </span>&nbsp;‡∏ß‡∏±‡∏ô
                </span>`;
                        }
                      }
                      return "";
                    })()}
                </div>

                <!-- Asset Details Grid -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Basic Information -->
                    <div class="bg-gray-50 p-6 rounded-xl">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                            <svg class="w-5 h-5 mr-2 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô
                        </h3>
                        <div class="space-y-3">
                            <div class="flex items-center">
                                <span class="text-gray-600 w-24">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:</span>
                                <span class="font-medium">${asset.type}</span>
                            </div>
                            <div class="flex items-center">
                                <span class="text-gray-600 w-24">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£:</span>
                                <span class="font-medium">${asset.name}</span>
                            </div>
                            <div class="flex items-center">
                                <span class="text-gray-600 w-24">‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö:</span>
                                <span class="font-medium">${asset.owner}</span>
                            </div>
                            ${
                              asset.location
                                ? `
                            <div class="flex items-center">
                                <span class="text-gray-600 w-24">‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà:</span>
                                <span class="font-medium">${asset.location}</span>
                            </div>
                            `
                                : ""
                            }
                        </div>
                    </div>

                    <!-- Registration & Dates -->
                    <div class="bg-gray-50 p-6 rounded-xl">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                            <svg class="w-5 h-5 mr-2 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå
                        </h3>
                        <div class="space-y-3">
                            ${
                              asset.registration_number
                                ? `
                            <div class="flex items-center">
                                <span class="text-gray-600 w-32">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå:</span>
                                <span class="font-medium font-mono text-sm bg-white px-2 py-1 rounded border">${asset.registration_number}</span>
                            </div>
                            `
                                : ""
                            }
                            ${
                              asset.budget_year
                                ? `
                            <div class="flex items-center">
                                <span class="text-gray-600 w-32">‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì:</span>
                                <span class="font-medium">${asset.budget_year}</span>
                            </div>
                            `
                                : ""
                            }
                            ${
                              asset.purchase_date
                                ? `
                            <div class="flex items-center">
                                <span class="text-gray-600 w-32">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡∏ã‡∏∑‡πâ‡∏≠:</span>
                                <span class="font-medium">${formatDate(
                                  asset.purchase_date
                                )}</span>
                            </div>
                            `
                                : ""
                            }
                            ${
                              asset.lifespan
                                ? `
                            <div class="flex items-center">
                            <span class="text-gray-600 w-32">‡∏≠‡∏≤‡∏¢‡∏∏‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô:</span>
                            <span class="font-medium">${asset.lifespan} ‡∏õ‡∏µ</span>
                            </div>
                            `
                                : ""
                            }
                            ${
                              asset.expiry_date
                                ? `
                            <div class="flex items-center">
                                <span class="text-gray-600 w-32">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏:</span>
                                <span class="font-medium">${formatDate(
                                  asset.expiry_date
                                )}</span>
                            </div>
                            `
                                : ""
                            }
                            ${
                              asset.install_date
                                ? `
                            <div class="flex items-center">
                              <span class="text-gray-600 w-32">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á:</span>
                              <span class="font-medium">${formatDate(
                                asset.install_date
                              )}</span>
                            </div>
                            `
                                : ""
                            }
                        </div>
                    </div>
                </div>

                ${
                  asset.specifications
                    ? `
                <!-- Specifications -->
                <div class="bg-blue-50 p-6 rounded-xl mt-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                        <svg class="w-5 h-5 mr-2 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                        </svg>
                        ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≥‡πÄ‡∏û‡∏≤‡∏∞
                    </h3>
                    <div class="bg-white p-4 rounded-lg border">
                        <p class="text-gray-700 whitespace-pre-wrap">${asset.specifications}</p>
                    </div>
                </div>
                `
                    : ""
                }

                ${
                  asset.notes
                    ? `
                <!-- Notes -->
                <div class="bg-yellow-50 p-6 rounded-xl mt-6 border-l-4 ${
                  asset.risk === "‡∏™‡∏π‡∏á" ? "border-red-400" : "border-yellow-400"
                }">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                        <svg class="w-5 h-5 mr-2 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                        </svg>
                        ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏
                    </h3>
                    <div class="bg-white p-4 rounded-lg border">
                        <p class="text-gray-700 whitespace-pre-wrap">${
                          asset.notes
                        }</p>
                    </div>
                </div>
                `
                    : ""
                }

                <!-- Timestamps -->
                <div class="bg-gray-50 p-4 rounded-xl mt-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-600">
                        ${
                          asset.created_at
                            ? `
                        <div class="flex items-center">
                            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                            </svg>
                            <span>‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠: ${new Date(
                              asset.created_at
                            ).toLocaleString("th-TH")}</span>
                        </div>
                        `
                            : ""
                        }
                        ${
                          asset.updated_at
                            ? `
                        <div class="flex items-center">
                            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                            </svg>
                            <span>‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: ${new Date(
                              asset.updated_at
                            ).toLocaleString("th-TH")}</span>
                        </div>
                        `
                            : ""
                        }
                    </div>
                </div>
            `;

        document.getElementById("viewAssetModal").classList.remove("hidden");
        document.getElementById("viewAssetModal").classList.add("flex");
      }

      function closeViewAssetModal() {
        document.getElementById("viewAssetModal").classList.add("hidden");
        document.getElementById("viewAssetModal").classList.remove("flex");
      }

      function closeAssetModal() {
        document.getElementById("assetModal").classList.add("hidden");
        document.getElementById("assetModal").classList.remove("flex");
      }

      async function handleAssetSubmit(e) {
        e.preventDefault();

        const submitBtn = document.getElementById("submitBtn");
        const originalText = submitBtn.textContent;
        submitBtn.textContent = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...";
        submitBtn.disabled = true;

        try {
          // Validate required fields
          const requiredFields = [
            "assetType",
            "assetName",
            "assetCritical",
            "assetRisk",
            "assetStatus",
            "assetOwner",
          ];
          for (const fieldId of requiredFields) {
            const field = document.getElementById(fieldId);
            if (!field.value.trim()) {
              throw new Error(
                `‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å${field.previousElementSibling.textContent.replace(
                  " *",
                  ""
                )}`
              );
            }
          }

          const assetData = {
            type: document.getElementById("assetType").value.trim(),
            name: document.getElementById("assetName").value.trim(),
            critical: document.getElementById("assetCritical").value.trim(),
            risk: document.getElementById("assetRisk").value.trim(),
            status: document.getElementById("assetStatus").value.trim(),
            purchase_date:
              document.getElementById("assetPurchaseDate").value || null,
            lifespan: document.getElementById("assetLifespan").value || null, // ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
            expiry_date:
              document.getElementById("assetExpiryDate").value || null,
            install_date:
              document.getElementById("assetInstallDate").value || null,
            budget_year: document.getElementById("assetBudgetYear").value
              ? parseInt(document.getElementById("assetBudgetYear").value)
              : null,
            registration_number:
              document.getElementById("assetRegistrationNumber").value.trim() ||
              null,
            specifications:
              document.getElementById("assetSpecifications").value.trim() ||
              null,
            owner: document.getElementById("assetOwner").value.trim(),
            location:
              document.getElementById("assetLocation").value.trim() || null,
            notes: document.getElementById("assetNotes").value.trim() || null,
          };

          const savedAsset = await saveAssetToSupabase(
            assetData,
            !!editingAssetId
          );

          // If adding new asset, go to first page to show it
          if (!editingAssetId) {
            currentPage = 1;
          }

          // Refresh all sections with updated data
          updateAllSections();
          closeAssetModal();

          const action = editingAssetId ? "‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç" : "‡πÄ‡∏û‡∏¥‡πà‡∏°";
          showNotification(
            `${action}‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à - ${savedAsset.name}`,
            "success"
          );
        } catch (error) {
          console.error("Error saving asset:", error);
          showNotification(
            error.message || "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•",
            "error"
          );
        } finally {
          submitBtn.textContent = originalText;
          submitBtn.disabled = false;
        }
      }

      // Utility functions
      function getTypeColor(type) {
        const colors = {
          Hardware: "bg-blue-100 text-blue-800",
          Software: "bg-green-100 text-green-800",
          Network: "bg-purple-100 text-purple-800",
          "People/Data/Docs": "bg-orange-100 text-orange-800",
        };
        return colors[type] || "bg-gray-100 text-gray-800";
      }

      function getTypeIcon(type) {
        const icons = {
          Hardware: "üíª",
          Software: "üíø",
          Network: "üåê",
          "People/Data/Docs": "üìÑ",
        };
        return icons[type] || "üìã";
      }

      function getRiskColor(risk) {
        const colors = {
          ‡∏™‡∏π‡∏á: "bg-red-100 text-red-800",
          ‡∏Å‡∏•‡∏≤‡∏á: "bg-yellow-100 text-yellow-800",
          ‡∏ï‡πà‡∏≥: "bg-green-100 text-green-800",
        };
        return colors[risk] || "bg-gray-100 text-gray-800";
      }

      function getRiskIcon(risk) {
        const icons = {
          ‡∏™‡∏π‡∏á: "",
          ‡∏Å‡∏•‡∏≤‡∏á: "",
          ‡∏ï‡πà‡∏≥: "",
        };
        return icons[risk] || "";
      }

      function getStatusColor(status) {
        const colors = {
          ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô: "bg-green-100 text-green-800",
          ‡∏™‡∏≥‡∏£‡∏≠‡∏á: "bg-blue-100 text-blue-800",
          ‡∏ä‡∏≥‡∏£‡∏∏‡∏î: "bg-red-100 text-red-800",
          ‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°: "bg-orange-100 text-orange-800",
          ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô: "bg-gray-100 text-gray-800",
        };
        return colors[status] || "bg-gray-100 text-gray-800";
      }

      function getStatusIcon(status) {
        const icons = {
          ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô: "",
          ‡∏™‡∏≥‡∏£‡∏≠‡∏á: "",
          ‡∏ä‡∏≥‡∏£‡∏∏‡∏î: "",
          ‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°: "",
          ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô: "",
        };
        return icons[status] || "";
      }

      function formatDate(dateString) {
        if (!dateString) return "-";
        const date = new Date(dateString);
        return date.toLocaleDateString("th-TH");
      }

      // Export functions
      function exportReport(type, format) {
        console.log("Export Report Called:", {
          type,
          format,
          assetsLength: assets.length,
        });

        let data = [];
        let reportTitle = "";

        switch (type) {
          case "all":
            data = [...assets]; // Create a copy
            reportTitle = "‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î";
            break;
          case "high-risk":
            data = assets.filter((a) => a.risk === "‡∏™‡∏π‡∏á");
            reportTitle = "‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏á";
            break;
          case "expiry":
            data = getExpiryAssets();
            reportTitle = "‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÅ‡∏•‡∏∞ License";
            break;
          case "alerts":
            data = assets.filter(
              (a) =>
                (a.notes &&
                  (a.notes.includes("‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏") ||
                    a.notes.includes("> 7 ‡∏õ‡∏µ"))) ||
                a.risk === "‡∏™‡∏π‡∏á" ||
                a.status === "‡∏ä‡∏≥‡∏£‡∏∏‡∏î"
            );
            reportTitle = "‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô";
            break;
        }

        console.log("Filtered Data:", { type, dataLength: data.length });

        // If no data exists at all, show message
        if (assets.length === 0) {
          showNotification(
            "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô",
            "error"
          );
          return;
        }

        // If filtered data is empty, still allow export with message
        if (data.length === 0) {
          let message = "";
          switch (type) {
            case "high-risk":
              message = `‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏á (‡∏à‡∏≤‡∏Å ${assets.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)`;
              break;
            case "expiry":
              message = `‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ (‡∏à‡∏≤‡∏Å ${assets.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)`;
              break;
            case "alerts":
              message = `‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô (‡∏à‡∏≤‡∏Å ${assets.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)`;
              break;
            default:
              message = "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ô‡∏µ‡πâ";
          }

          // Create empty report with summary
          if (format === "excel") {
            exportEmptyExcelReport(reportTitle, message);
          } else if (format === "pdf") {
            exportEmptyPDFReport(reportTitle, message);
          }
          return;
        }

        // Export with data
        if (format === "excel") {
          exportToExcel(data, type, reportTitle);
        } else if (format === "pdf") {
          exportToPDF(data, type, reportTitle);
        }
      }

      // Export empty reports
      function exportEmptyExcelReport(reportTitle, message) {
        try {
          showNotification("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô Excel...", "info");

          const wb = XLSX.utils.book_new();

          // Create summary data for empty report
          const summaryData = [
            [reportTitle],
            ["IT Asset Inventory System"],
            [""],
            ["‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô", new Date().toLocaleDateString("th-TH")],
            ["‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á", new Date().toLocaleTimeString("th-TH")],
            [""],
            ["‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô", message],
            ["‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£", "0 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£"],
            [""],
            ["‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏", "‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î"],
            ["", "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏á"],
          ];

          const ws = XLSX.utils.aoa_to_sheet(summaryData);
          ws["!cols"] = [{ wch: 25 }, { wch: 40 }];

          XLSX.utils.book_append_sheet(wb, ws, "‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô");

          const filename = `${reportTitle}_${
            new Date().toISOString().split("T")[0]
          }.xlsx`;
          XLSX.writeFile(wb, filename);

          showNotification(
            `‚úÖ ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô Excel ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à\nüìÑ ${filename}\nüìä ${message}`,
            "success"
          );
        } catch (error) {
          console.error("Excel Export Error:", error);
          showNotification("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å Excel", "error");
        }
      }

      function exportEmptyPDFReport(reportTitle, message) {
        try {
          showNotification("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô PDF...", "info");

          const { jsPDF } = window.jspdf;
          const doc = new jsPDF();

          // Header
          doc.setFontSize(18);
          doc.setTextColor(37, 99, 235);
          doc.text(reportTitle, 105, 30, { align: "center" });

          doc.setFontSize(12);
          doc.setTextColor(107, 114, 128);
          doc.text("IT Asset Inventory System", 105, 40, { align: "center" });

          // Report info
          doc.setFontSize(10);
          doc.setTextColor(0, 0, 0);
          doc.text(`‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ${new Date().toLocaleDateString("th-TH")}`, 20, 60);
          doc.text(`‡πÄ‡∏ß‡∏•‡∏≤: ${new Date().toLocaleTimeString("th-TH")}`, 20, 70);

          // Message
          doc.setFontSize(14);
          doc.setTextColor(156, 163, 175);
          doc.text(message, 105, 120, { align: "center" });
          doc.text("‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î", 105, 140, {
            align: "center",
          });

          // Footer
          doc.setFontSize(8);
          doc.setTextColor(107, 114, 128);
          doc.text(
            `‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏î‡∏¢ IT Asset Inventory System | ${new Date().toLocaleString(
              "th-TH"
            )}`,
            105,
            280,
            { align: "center" }
          );

          const filename = `${reportTitle}_${
            new Date().toISOString().split("T")[0]
          }.pdf`;
          doc.save(filename);

          showNotification(
            `‚úÖ ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô PDF ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à\nüìÑ ${filename}\nüìä ${message}`,
            "success"
          );
        } catch (error) {
          console.error("PDF Export Error:", error);
          showNotification("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å PDF", "error");
        }
      }

      // Create sample data for export demonstration
      function createSampleDataForExport(type, format, reportTitle) {
        const sampleData = [
          {
            id: 1,
            type: "Hardware",
            name: "Server Dell PowerEdge R740",
            critical: "‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç",
            risk: "‡∏™‡∏π‡∏á",
            status: "‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô",
            owner: "‡∏ù‡πà‡∏≤‡∏¢ IT",
            location: "‡∏´‡πâ‡∏≠‡∏á Server ‡∏ä‡∏±‡πâ‡∏ô 3",
            registration_number: "IT-HW-001-2567",
            purchase_date: "2017-01-15",
            expiry_date: "2024-12-31",
            budget_year: 2560,
            specifications: "Intel Xeon Silver 4214, 32GB RAM, 2TB SSD RAID1",
            notes: "‡∏≠‡∏≤‡∏¢‡∏∏‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô > 7 ‡∏õ‡∏µ ‡∏ï‡πâ‡∏≠‡∏á‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô",
            created_at: "2024-01-01T08:00:00Z",
            updated_at: "2024-01-15T10:30:00Z",
          },
          {
            id: 2,
            type: "Software",
            name: "Microsoft Office 365 Business",
            critical: "‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç",
            risk: "‡∏Å‡∏•‡∏≤‡∏á",
            status: "‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô",
            owner: "‡∏ù‡πà‡∏≤‡∏¢‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£",
            location: "‡∏ó‡∏∏‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å",
            registration_number: "IT-SW-002-2567",
            purchase_date: "2023-03-01",
            expiry_date: "2024-03-01",
            budget_year: 2566,
            specifications: "50 User License, Business Premium Plan",
            notes: "License ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ ‡∏°‡∏µ.‡∏Ñ. 2567 ‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡πà‡∏≠‡∏≠‡∏≤‡∏¢‡∏∏",
            created_at: "2024-01-01T08:00:00Z",
            updated_at: "2024-01-15T10:30:00Z",
          },
          {
            id: 3,
            type: "Network",
            name: "Cisco Catalyst 2960-X Switch",
            critical: "‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç",
            risk: "‡∏ï‡πà‡∏≥",
            status: "‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô",
            owner: "‡∏ù‡πà‡∏≤‡∏¢ IT",
            location: "‡∏´‡πâ‡∏≠‡∏á Network ‡∏ä‡∏±‡πâ‡∏ô 2",
            registration_number: "IT-NW-003-2567",
            purchase_date: "2022-06-15",
            expiry_date: null,
            budget_year: 2565,
            specifications: "24-Port Gigabit Ethernet, 4x SFP+ Uplinks",
            notes: "‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥ ‡∏°‡∏µ Warranty ‡∏ñ‡∏∂‡∏á 2025",
            created_at: "2024-01-01T08:00:00Z",
            updated_at: "2024-01-15T10:30:00Z",
          },
          {
            id: 4,
            type: "People/Data/Docs",
            name: "‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ CRM",
            critical: "‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç",
            risk: "‡∏™‡∏π‡∏á",
            status: "‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô",
            owner: "‡∏ù‡πà‡∏≤‡∏¢‡∏Ç‡∏≤‡∏¢",
            location: "Cloud Server AWS",
            registration_number: "IT-DB-004-2567",
            purchase_date: "2021-01-01",
            expiry_date: null,
            budget_year: 2564,
            specifications: "MySQL 8.0, 500GB Storage, Daily Backup",
            notes: "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç ‡∏ï‡πâ‡∏≠‡∏á Backup ‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô",
            created_at: "2024-01-01T08:00:00Z",
            updated_at: "2024-01-15T10:30:00Z",
          },
          {
            id: 5,
            type: "Hardware",
            name: "Workstation HP Z4 G4",
            critical: "‡πÑ‡∏°‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç",
            risk: "‡∏Å‡∏•‡∏≤‡∏á",
            status: "‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°",
            owner: "‡∏ù‡πà‡∏≤‡∏¢‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö",
            location: "‡∏´‡πâ‡∏≠‡∏á‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö ‡∏ä‡∏±‡πâ‡∏ô 4",
            registration_number: "IT-HW-005-2567",
            purchase_date: "2020-08-20",
            expiry_date: null,
            budget_year: 2563,
            specifications: "Intel Xeon W-2123, 64GB RAM, NVIDIA Quadro P2000",
            notes: "‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°‡πÅ‡∏•‡πâ‡∏ß ‡∏£‡∏≠‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏° ‡∏Ñ‡∏≤‡∏î‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏™‡∏£‡πá‡∏à‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 7 ‡∏ß‡∏±‡∏ô",
            created_at: "2024-01-01T08:00:00Z",
            updated_at: "2024-01-15T10:30:00Z",
          },
        ];

        // Filter sample data based on report type
        let filteredSampleData = [];
        switch (type) {
          case "all":
            filteredSampleData = sampleData;
            break;
          case "high-risk":
            filteredSampleData = sampleData.filter((a) => a.risk === "‡∏™‡∏π‡∏á");
            break;
          case "expiry":
            filteredSampleData = sampleData.filter(
              (a) =>
                (a.notes &&
                  (a.notes.includes("‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏") ||
                    a.notes.includes("> 7 ‡∏õ‡∏µ") ||
                    a.notes.includes("‡∏ï‡πà‡∏≠‡∏≠‡∏≤‡∏¢‡∏∏"))) ||
                (a.expiry_date &&
                  new Date(a.expiry_date) <=
                    new Date(Date.now() + 90 * 24 * 60 * 60 * 1000))
            );
            break;
          case "alerts":
            filteredSampleData = sampleData.filter(
              (a) =>
                (a.notes &&
                  (a.notes.includes("‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏") ||
                    a.notes.includes("> 7 ‡∏õ‡∏µ") ||
                    a.notes.includes("‡∏ï‡πà‡∏≠‡∏≠‡∏≤‡∏¢‡∏∏") ||
                    a.notes.includes("‡πÄ‡∏™‡∏µ‡∏¢"))) ||
                a.risk === "‡∏™‡∏π‡∏á" ||
                a.status === "‡∏ä‡∏≥‡∏£‡∏∏‡∏î"
            );
            break;
        }

        if (filteredSampleData.length === 0) {
          showNotification(
            `‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô "${reportTitle}"`,
            "error"
          );
          return;
        }

        showNotification(
          `üìä ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á "${reportTitle}" (${filteredSampleData.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)`,
          "info"
        );

        if (format === "excel") {
          exportToExcel(filteredSampleData, type, reportTitle + " (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á)");
        } else if (format === "pdf") {
          exportToPDF(filteredSampleData, type, reportTitle + " (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á)");
        }
      }

      function getExpiryAssets() {
        const today = new Date();
        const threeMonthsFromNow = new Date();
        threeMonthsFromNow.setMonth(today.getMonth() + 3);

        return assets.filter((asset) => {
          let isExpiring = false;

          // Check expiry date
          if (asset.expiry_date) {
            const expiryDate = new Date(asset.expiry_date);
            if (expiryDate <= threeMonthsFromNow) {
              isExpiring = true;
            }
          }

          // Check notes for license expiry keywords
          if (asset.notes) {
            const notes = asset.notes.toLowerCase();
            const expiryKeywords = [
              "‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏",
              "expire",
              "expired",
              "license",
              "‡πÑ‡∏•‡πÄ‡∏ã‡∏ô‡∏™‡πå",
              "renew",
              "‡∏ï‡πà‡∏≠‡∏≠‡∏≤‡∏¢‡∏∏",
              "subscription",
              "‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å",
              "‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏",
              "‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏",
              "expiring",
              "renewal",
              "‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡πà‡∏≠‡∏≠‡∏≤‡∏¢‡∏∏",
            ];

            if (expiryKeywords.some((keyword) => notes.includes(keyword))) {
              isExpiring = true;
            }
          }

          // Check if asset is old (more than 7 years based on purchase date)
          if (asset.purchase_date) {
            const purchaseDate = new Date(asset.purchase_date);
            const sevenYearsAgo = new Date();
            sevenYearsAgo.setFullYear(today.getFullYear() - 7);

            if (purchaseDate <= sevenYearsAgo) {
              isExpiring = true;
            }
          }

          // Check if asset type is software and might need license renewal
          if (asset.type === "Software" && !asset.expiry_date && !asset.notes) {
            // Assume software without expiry info might need attention
            if (asset.purchase_date) {
              const purchaseDate = new Date(asset.purchase_date);
              const oneYearAgo = new Date();
              oneYearAgo.setFullYear(today.getFullYear() - 1);

              if (purchaseDate <= oneYearAgo) {
                isExpiring = true;
              }
            }
          }

          return isExpiring;
        });
      }

      function exportToExcel(data, reportType, reportTitle) {
        try {
          showNotification("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå Excel...", "info");

          // Check if XLSX library is loaded
          if (typeof XLSX === "undefined") {
            throw new Error(
              "‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ Excel ‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÉ‡∏´‡∏°‡πà"
            );
          }

          // Prepare data for Excel with Thai headers
          // ‚úÖ ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡πÄ‡∏Å‡πà‡∏≤‡∏™‡∏∏‡∏î ‚Üí ‡πÉ‡∏´‡∏°‡πà‡∏™‡∏∏‡∏î ‡∏Å‡πà‡∏≠‡∏ô map
          const sortedData = [...data].sort((a, b) => {
            const dateA = new Date(a.created_at);
            const dateB = new Date(b.created_at);
            return dateA - dateB; // ‡πÄ‡∏Å‡πà‡∏≤‡∏Å‡πà‡∏≠‡∏ô ‚Üí ‡πÉ‡∏´‡∏°‡πà‡∏´‡∏•‡∏±‡∏á
          });

          const excelData = sortedData.map((asset, index) => ({
            ‡∏•‡∏≥‡∏î‡∏±‡∏ö: index + 1,
            ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå: asset.type || "",
            ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå: asset.name || "",
            ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: asset.critical || "",
            ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á: asset.risk || "",
            ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô: asset.status || "",
            ‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö: asset.owner || "",
            ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á: asset.location || "",
            ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå: asset.registration_number || "",
            ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡∏ã‡∏∑‡πâ‡∏≠: asset.purchase_date
              ? formatDateForExcel(asset.purchase_date)
              : "",
            ‡∏≠‡∏≤‡∏¢‡∏∏‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô: asset.lifespan || "",
            ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏: asset.expiry_date
              ? formatDateForExcel(asset.expiry_date)
              : "",
            ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á: asset.install_date
              ? formatDateForExcel(asset.install_date)
              : "",
            ‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì: asset.budget_year || "",
            ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≥‡πÄ‡∏û‡∏≤‡∏∞: asset.specifications || "",
            ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: asset.notes || "",
            ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: asset.created_at
              ? formatDateTimeForExcel(asset.created_at)
              : "",
            ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: asset.updated_at
              ? formatDateTimeForExcel(asset.updated_at)
              : "",
          }));

          // Create worksheet
          const ws = XLSX.utils.json_to_sheet(excelData);

          // Set column widths
          const colWidths = [
            { wch: 8 }, // ‡∏•‡∏≥‡∏î‡∏±‡∏ö
            { wch: 15 }, // ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå
            { wch: 30 }, // ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå
            { wch: 12 }, // ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç
            { wch: 15 }, // ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á
            { wch: 15 }, // ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
            { wch: 20 }, // ‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö
            { wch: 20 }, // ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á
            { wch: 18 }, // ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå
            { wch: 15 }, // ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡∏ã‡∏∑‡πâ‡∏≠
            { wch: 15 }, // ‡∏≠‡∏≤‡∏¢‡∏∏‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
            { wch: 15 }, // ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏
            { wch: 12 }, // ‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì
            { wch: 25 }, // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≥‡πÄ‡∏û‡∏≤‡∏∞
            { wch: 25 }, // ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏
            { wch: 18 }, // ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            { wch: 18 }, // ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
          ];
          ws["!cols"] = colWidths;

          // Create workbook
          const wb = XLSX.utils.book_new();

          // Add summary sheet
          const summaryData = createSummaryData(data, reportTitle);
          const summaryWs = XLSX.utils.aoa_to_sheet(summaryData);
          summaryWs["!cols"] = [{ wch: 25 }, { wch: 15 }, { wch: 40 }];
          XLSX.utils.book_append_sheet(wb, summaryWs, "‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô");

          // Add main data sheet
          XLSX.utils.book_append_sheet(wb, ws, "‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•");

          // Generate filename with safe characters
          const currentDate = new Date();
          const dateStr = currentDate.toISOString().split("T")[0];
          const timeStr = currentDate
            .toTimeString()
            .split(" ")[0]
            .replace(/:/g, "-");
          const safeTitle = reportTitle
            .replace(/[^\w\s-]/g, "")
            .replace(/\s+/g, "_");
          const filename = `${safeTitle}_${dateStr}_${timeStr}.xlsx`;

          // Save file
          XLSX.writeFile(wb, filename);

          showNotification(
            `‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å Excel ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à\n ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• : ${data.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`,
            "success"
          );
        } catch (error) {
          console.error("Excel Export Error:", error);
          showNotification(
            `‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å Excel: ${error.message}`,
            "error"
          );
        }
      }

      function createSummaryData(data, reportTitle) {
        const currentDate = new Date();
        const thaiDate = currentDate.toLocaleDateString("th-TH", {
          year: "numeric",
          month: "long",
          day: "numeric",
        });

        // Calculate statistics
        const stats = {
          total: data.length,
          hardware: data.filter((a) => a.type === "Hardware").length,
          software: data.filter((a) => a.type === "Software").length,
          network: data.filter((a) => a.type === "Network").length,
          data: data.filter((a) => a.type === "People/Data/Docs").length,
          highRisk: data.filter((a) => a.risk === "‡∏™‡∏π‡∏á").length,
          mediumRisk: data.filter((a) => a.risk === "‡∏Å‡∏•‡∏≤‡∏á").length,
          lowRisk: data.filter((a) => a.risk === "‡∏ï‡πà‡∏≥").length,
          active: data.filter((a) => a.status === "‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô").length,
          backup: data.filter((a) => a.status === "‡∏™‡∏≥‡∏£‡∏≠‡∏á").length,
          broken: data.filter((a) => a.status === "‡∏ä‡∏≥‡∏£‡∏∏‡∏î").length,
          repair: data.filter((a) => a.status === "‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°").length,
          inactive: data.filter((a) => a.status === "‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô").length,
        };

        return [
          [reportTitle, "", ""],
          ["IT Asset Inventory System", "", ""],
          ["", "", ""],
          ["‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô", thaiDate, ""],
          ["‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á", currentDate.toLocaleTimeString("th-TH"), ""],
          ["‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î", stats.total, "‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£"],
          ["", "", ""],
          ["‡∏™‡∏£‡∏∏‡∏õ‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó", "", ""],
          ["Hardware", stats.hardware, "‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£"],
          ["Software", stats.software, "‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£"],
          ["Network", stats.network, "‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£"],
          ["People/Data/Docs", stats.data, "‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£"],
          ["", "", ""],
          ["‡∏™‡∏£‡∏∏‡∏õ‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á", "", ""],
          ["‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏á", stats.highRisk, "‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£"],
          ["‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á", stats.mediumRisk, "‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£"],
          ["‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ï‡πà‡∏≥", stats.lowRisk, "‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£"],
          ["", "", ""],
          ["‡∏™‡∏£‡∏∏‡∏õ‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞", "", ""],
          ["‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô", stats.active, "‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£"],
          ["‡∏™‡∏≥‡∏£‡∏≠‡∏á", stats.backup, "‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£"],
          ["‡∏ä‡∏≥‡∏£‡∏∏‡∏î", stats.broken, "‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£"],
          ["‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°", stats.repair, "‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£"],
          ["‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô", stats.inactive, "‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£"],
          ["", "", ""],
          ["‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏", "‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ô‡∏µ‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏î‡∏¢‡∏£‡∏∞‡∏ö‡∏ö IT Asset Inventory", ""],
        ];
      }

      function formatDateForExcel(dateString) {
        if (!dateString) return "";
        const date = new Date(dateString);
        return date.toLocaleDateString("th-TH");
      }

      function formatDateTimeForExcel(dateString) {
        if (!dateString) return "";
        const date = new Date(dateString);
        return date.toLocaleString("th-TH");
      }

      /*function exportToPDF(data, reportType, reportTitle) {
            try {
                // Show loading notification
                showNotification('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô PDF...', 'info');
                
                // Check if jsPDF library is loaded
                if (typeof window.jspdf === 'undefined') {
                    throw new Error('‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ PDF ‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÉ‡∏´‡∏°‡πà');
                }
                
                const currentDate = new Date();
                const thaiDate = currentDate.toLocaleDateString('th-TH', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
                
                // Calculate summary statistics
                const stats = {
                    total: data.length,
                    hardware: data.filter(a => a.type === 'Hardware').length,
                    software: data.filter(a => a.type === 'Software').length,
                    network: data.filter(a => a.type === 'Network').length,
                    data: data.filter(a => a.type === 'People/Data/Docs').length,
                    highRisk: data.filter(a => a.risk === '‡∏™‡∏π‡∏á').length,
                    mediumRisk: data.filter(a => a.risk === '‡∏Å‡∏•‡∏≤‡∏á').length,
                    lowRisk: data.filter(a => a.risk === '‡∏ï‡πà‡∏≥').length,
                    active: data.filter(a => a.status === '‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô').length,
                    backup: data.filter(a => a.status === '‡∏™‡∏≥‡∏£‡∏≠‡∏á').length,
                    broken: data.filter(a => a.status === '‡∏ä‡∏≥‡∏£‡∏∏‡∏î').length,
                    inactive: data.filter(a => a.status === '‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô').length
                };
                
                // Create PDF using jsPDF
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF({
                    orientation: 'landscape',
                    unit: 'mm',
                    format: 'a4'
                });
                
                // Header
                doc.setFontSize(18);
                doc.setTextColor(37, 99, 235);
                doc.text(reportTitle, 148, 20, { align: 'center' });
                
                doc.setFontSize(12);
                doc.setTextColor(107, 114, 128);
                doc.text('IT Asset Inventory System', 148, 28, { align: 'center' });
                
                // Report info
                doc.setFontSize(10);
                doc.setTextColor(0, 0, 0);
                doc.text(`‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô: ${thaiDate}`, 20, 40);
                doc.text(`Generated: ${currentDate.toLocaleTimeString('th-TH')}`, 20, 46);
                doc.text(`Total Items: ${data.length} records`, 20, 52);
                doc.text('System: IT Asset Inventory', 20, 58);
                
                // Summary statistics
                if (data.length > 0) {
                    doc.setFontSize(12);
                    doc.setTextColor(37, 99, 235);
                    doc.text('Summary Overview', 148, 70, { align: 'center' });
                    
                    doc.setFontSize(9);
                    doc.setTextColor(0, 0, 0);
                    
                    // Type statistics
                    doc.text(`Hardware: ${stats.hardware}`, 30, 80);
                    doc.text(`Software: ${stats.software}`, 80, 80);
                    doc.text(`Network: ${stats.network}`, 130, 80);
                    doc.text(`Data/Docs: ${stats.data}`, 180, 80);
                    
                    // Risk statistics
                    doc.text(`High Risk: ${stats.highRisk}`, 30, 88);
                    doc.text(`Medium Risk: ${stats.mediumRisk}`, 80, 88);
                    doc.text(`Low Risk: ${stats.lowRisk}`, 130, 88);
                    doc.text(`Active: ${stats.active}`, 180, 88);
                }
                
                // Table header
                let yPos = data.length > 0 ? 100 : 70;
                
                if (data.length === 0) {
                    doc.setFontSize(14);
                    doc.setTextColor(156, 163, 175);
                    doc.text('No data available for this report', 148, yPos + 30, { align: 'center' });
                    doc.text('Please check your filters or add data to the system', 148, yPos + 40, { align: 'center' });
                } else {
                    // Table headers
                    doc.setFontSize(8);
                    doc.setTextColor(255, 255, 255);
                    doc.setFillColor(37, 99, 235);
                    doc.rect(15, yPos, 267, 8, 'F');
                    
                    doc.text('#', 18, yPos + 5);
                    doc.text('Type', 25, yPos + 5);
                    doc.text('Asset Name', 50, yPos + 5);
                    doc.text('Critical', 100, yPos + 5);
                    doc.text('Risk', 125, yPos + 5);
                    doc.text('Status', 150, yPos + 5);
                    doc.text('Owner', 175, yPos + 5);
                    doc.text('Location', 210, yPos + 5);
                    doc.text('Notes', 240, yPos + 5);
                    
                    yPos += 10;
                    
                    // Table rows
                    doc.setTextColor(0, 0, 0);
                    data.forEach((asset, index) => {
                        if (yPos > 190) { // New page if needed
                            doc.addPage();
                            yPos = 20;
                            
                            // Repeat header on new page
                            doc.setFontSize(8);
                            doc.setTextColor(255, 255, 255);
                            doc.setFillColor(37, 99, 235);
                            doc.rect(15, yPos, 267, 8, 'F');
                            
                            doc.text('#', 18, yPos + 5);
                            doc.text('Type', 25, yPos + 5);
                            doc.text('Asset Name', 50, yPos + 5);
                            doc.text('Critical', 100, yPos + 5);
                            doc.text('Risk', 125, yPos + 5);
                            doc.text('Status', 150, yPos + 5);
                            doc.text('Owner', 175, yPos + 5);
                            doc.text('Location', 210, yPos + 5);
                            doc.text('Notes', 240, yPos + 5);
                            
                            yPos += 10;
                            doc.setTextColor(0, 0, 0);
                        }
                        
                        // Alternate row colors
                        if (index % 2 === 0) {
                            doc.setFillColor(249, 250, 251);
                            doc.rect(15, yPos - 2, 267, 6, 'F');
                        }
                        
                        doc.setFontSize(7);
                        doc.text((index + 1).toString(), 18, yPos + 2);
                        doc.text(asset.type || '', 25, yPos + 2);
                        doc.text(asset.name ? asset.name.substring(0, 25) : '', 50, yPos + 2);
                        doc.text(asset.critical || '', 100, yPos + 2);
                        doc.text(asset.risk || '', 125, yPos + 2);
                        doc.text(asset.status || '', 150, yPos + 2);
                        doc.text(asset.owner ? asset.owner.substring(0, 15) : '', 175, yPos + 2);
                        doc.text(asset.location ? asset.location.substring(0, 12) : '-', 210, yPos + 2);
                        doc.text(asset.notes ? asset.notes.substring(0, 15) + '...' : '-', 240, yPos + 2);
                        
                        yPos += 6;
                    });
                }
                
                // Footer
                const pageCount = doc.internal.getNumberOfPages();
                for (let i = 1; i <= pageCount; i++) {
                    doc.setPage(i);
                    doc.setFontSize(8);
                    doc.setTextColor(107, 114, 128);
                    doc.text(`Generated by IT Asset Inventory System | ${new Date().toLocaleString('th-TH')}`, 148, 200, { align: 'center' });
                    doc.text(`Page ${i} of ${pageCount} | ${data.length} records`, 148, 205, { align: 'center' });
                }
                
                // Generate safe filename
                const dateStr = currentDate.toISOString().split('T')[0];
                const timeStr = currentDate.toTimeString().split(' ')[0].replace(/:/g, '-');
                const safeTitle = reportTitle.replace(/[^\w\s-]/g, '').replace(/\s+/g, '_');
                const filename = `${safeTitle}_${dateStr}_${timeStr}.pdf`;
                
                // Save the PDF
                doc.save(filename);
                
                showNotification(`‚úÖ ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å PDF ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!\nüìÑ ‡πÑ‡∏ü‡∏•‡πå: ${filename}\nüìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: ${data.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`, 'success');
                
            } catch (error) {
                console.error('PDF Export Error:', error);
                showNotification(`‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á PDF: ${error.message}`, 'error');
            }
        }*/

      // CSS for navigation and sections
      const style = document.createElement("style");
      style.textContent = `
            .tech-nav-btn {
                padding: 16px;
                border-radius: 12px;
                background: rgba(255, 255, 255, 0.05);
                backdrop-filter: blur(10px);
                border: 1px solid rgba(255, 255, 255, 0.1);
                color: #e2e8f0;
                cursor: pointer;
                transition: all 0.3s ease;
                font-weight: 500;
                display: flex;
                align-items: center;
                position: relative;
                overflow: hidden;
            }
            .tech-nav-btn::before {
                content: '';
                position: absolute;
                top: 0;
                left: -100%;
                width: 100%;
                height: 100%;
                background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
                transition: left 0.5s;
            }
            .tech-nav-btn:hover::before {
                left: 100%;
            }
            .tech-nav-btn:hover {
                background: rgba(255, 255, 255, 0.1);
                border-color: rgba(6, 182, 212, 0.5);
                transform: translateX(4px);
                box-shadow: 0 0 20px rgba(6, 182, 212, 0.2);
            }
            .tech-nav-btn.active {
                background: linear-gradient(135deg, rgba(6, 182, 212, 0.2), rgba(59, 130, 246, 0.2));
                border-color: rgba(6, 182, 212, 0.5);
                color: #ffffff;
                box-shadow: 0 0 25px rgba(6, 182, 212, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1);
                transform: translateX(6px);
            }
            .tech-nav-btn.active::after {
                content: '';
                position: absolute;
                left: 0;
                top: 0;
                bottom: 0;
                width: 3px;
                background: linear-gradient(to bottom, #06b6d4, #3b82f6);
                border-radius: 0 2px 2px 0;
                box-shadow: 0 0 10px rgba(6, 182, 212, 0.5);
            }
            .section {
                display: none !important;
            }
            .section.active {
                display: block !important;
            }
            .view-btn {
                display: flex;
                align-items: center;
                background: #f8fafc;
                color: #64748b;
                border: 1px solid #e2e8f0;
            }
            .view-btn:hover {
                background: #f1f5f9;
                color: #475569;
            }
            .view-btn.active {
                background: linear-gradient(to right, #3b82f6, #8b5cf6);
                color: white;
                border-color: #3b82f6;
                box-shadow: 0 4px 6px -1px rgba(59, 130, 246, 0.1);
            }
        `;
      document.head.appendChild(style);

      function calculateExpiry(purchaseDate, lifespanYears) {
        if (!purchaseDate || !lifespanYears) return "";
        const date = new Date(purchaseDate);
        date.setFullYear(date.getFullYear() + parseInt(lifespanYears));
        return date.toISOString().split("T")[0]; // ‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô YYYY-MM-DD
      }

      document.addEventListener("DOMContentLoaded", () => {
        const purchaseInput = document.getElementById("assetPurchaseDate");
        const lifespanInput = document.getElementById("assetLifespan");
        const expiryInput = document.getElementById("assetExpiryDate");

        function updateExpiry() {
          expiryInput.value = calculateExpiry(
            purchaseInput.value,
            lifespanInput.value
          );
        }

        if (purchaseInput && lifespanInput && expiryInput) {
          purchaseInput.addEventListener("change", updateExpiry);
          lifespanInput.addEventListener("input", updateExpiry);
        }
      });

      function updateMenuByRole(role) {
        const menuAssets = document.getElementById("menuAssets");
        const menuReports = document.getElementById("menuReports");

        // üîπ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÄ‡∏õ‡πá‡∏ô‡∏ã‡πà‡∏≠‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
        if (menuAssets) menuAssets.style.display = "none";
        if (menuReports) menuReports.style.display = "none";

        // üîπ ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞ admin
        if (role === "admin") {
          if (menuAssets) menuAssets.style.display = "block";
          if (menuReports) menuReports.style.display = "block";
        }
      }
    </script>
    <script>
      (function () {
        function c() {
          var b = a.contentDocument || a.contentWindow.document;
          if (b) {
            var d = b.createElement("script");
            d.innerHTML =
              "window.__CF$cv$params={r:'970f4a4e93067329',t:'MTc1NTQ5Nzg2OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";
            b.getElementsByTagName("head")[0].appendChild(d);
          }
        }
        if (document.body) {
          var a = document.createElement("iframe");
          a.height = 1;
          a.width = 1;
          a.style.position = "absolute";
          a.style.top = 0;
          a.style.left = 0;
          a.style.border = "none";
          a.style.visibility = "hidden";
          document.body.appendChild(a);
          if ("loading" !== document.readyState) c();
          else if (window.addEventListener)
            document.addEventListener("DOMContentLoaded", c);
          else {
            var e = document.onreadystatechange || function () {};
            document.onreadystatechange = function (b) {
              e(b);
              "loading" !== document.readyState &&
                ((document.onreadystatechange = e), c());
            };
          }
        }
      })();
    </script>
  </body>
</html>




